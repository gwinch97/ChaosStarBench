---
# Source: social-network/charts/jaeger/charts/elasticsearch/templates/coordinating/networkpolicy.yaml
kind: NetworkPolicy
apiVersion: networking.k8s.io/v1
metadata:
  name: socialnetwork-elasticsearch-coordinating
  namespace: "default"
  labels:
    app.kubernetes.io/instance: socialnetwork
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: elasticsearch
    app.kubernetes.io/version: 8.13.2
    helm.sh/chart: elasticsearch-20.0.4
    app.kubernetes.io/component: coordinating-only
spec:
  podSelector:
    matchLabels:
      app.kubernetes.io/instance: socialnetwork
      app.kubernetes.io/name: elasticsearch
      app.kubernetes.io/component: coordinating-only
  policyTypes:
    - Ingress
    - Egress
  egress:
    - {}
  ingress:
    - ports:
        - port: 9200
        - port: 9300
---
# Source: social-network/charts/jaeger/charts/elasticsearch/templates/data/networkpolicy.yaml
kind: NetworkPolicy
apiVersion: networking.k8s.io/v1
metadata:
  name: socialnetwork-elasticsearch-data
  namespace: "default"
  labels:
    app.kubernetes.io/instance: socialnetwork
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: elasticsearch
    app.kubernetes.io/version: 8.13.2
    helm.sh/chart: elasticsearch-20.0.4
    app.kubernetes.io/component: data
spec:
  podSelector:
    matchLabels:
      app.kubernetes.io/instance: socialnetwork
      app.kubernetes.io/name: elasticsearch
      app.kubernetes.io/component: data
  policyTypes:
    - Ingress
    - Egress
  egress:
    - {}
  ingress:
    - ports:
        - port: 9200
        - port: 9300
---
# Source: social-network/charts/jaeger/charts/elasticsearch/templates/ingest/networkpolicy.yaml
kind: NetworkPolicy
apiVersion: networking.k8s.io/v1
metadata:
  name: socialnetwork-elasticsearch-ingest
  namespace: "default"
  labels:
    app.kubernetes.io/instance: socialnetwork
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: elasticsearch
    app.kubernetes.io/version: 8.13.2
    helm.sh/chart: elasticsearch-20.0.4
    app.kubernetes.io/component: ingest
spec:
  podSelector:
    matchLabels:
      app.kubernetes.io/instance: socialnetwork
      app.kubernetes.io/name: elasticsearch
      app.kubernetes.io/component: ingest
  policyTypes:
    - Ingress
    - Egress
  egress:
    - {}
  ingress:
    - ports:
        - port: 9200
        - port: 9300
---
# Source: social-network/charts/jaeger/charts/elasticsearch/templates/master/networkpolicy.yaml
kind: NetworkPolicy
apiVersion: networking.k8s.io/v1
metadata:
  name: socialnetwork-elasticsearch-master
  namespace: "default"
  labels:
    app.kubernetes.io/instance: socialnetwork
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: elasticsearch
    app.kubernetes.io/version: 8.13.2
    helm.sh/chart: elasticsearch-20.0.4
    app.kubernetes.io/component: master
spec:
  podSelector:
    matchLabels:
      app.kubernetes.io/instance: socialnetwork
      app.kubernetes.io/name: elasticsearch
      app.kubernetes.io/component: master
  policyTypes:
    - Ingress
    - Egress
  egress:
    - {}
  ingress:
    - ports:
        - port: 9200
        - port: 9300
---
# Source: social-network/charts/jaeger/charts/elasticsearch/templates/coordinating/serviceaccount.yaml
apiVersion: v1
kind: ServiceAccount
metadata:
  name: socialnetwork-elasticsearch-coordinating
  namespace: "default"
  labels:
    app.kubernetes.io/instance: socialnetwork
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: elasticsearch
    app.kubernetes.io/version: 8.13.2
    helm.sh/chart: elasticsearch-20.0.4
    app.kubernetes.io/component: coordinating-only
automountServiceAccountToken: false
---
# Source: social-network/charts/jaeger/charts/elasticsearch/templates/data/serviceaccount.yaml
apiVersion: v1
kind: ServiceAccount
metadata:
  name: socialnetwork-elasticsearch-data
  namespace: "default"
  labels:
    app.kubernetes.io/instance: socialnetwork
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: elasticsearch
    app.kubernetes.io/version: 8.13.2
    helm.sh/chart: elasticsearch-20.0.4
    app.kubernetes.io/component: data
automountServiceAccountToken: false
---
# Source: social-network/charts/jaeger/charts/elasticsearch/templates/ingest/serviceaccount.yaml
apiVersion: v1
kind: ServiceAccount
metadata:
  name: socialnetwork-elasticsearch-ingest
  namespace: "default"
  labels:
    app.kubernetes.io/instance: socialnetwork
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: elasticsearch
    app.kubernetes.io/version: 8.13.2
    helm.sh/chart: elasticsearch-20.0.4
    app.kubernetes.io/component: ingest
automountServiceAccountToken: false
---
# Source: social-network/charts/jaeger/charts/elasticsearch/templates/master/serviceaccount.yaml
apiVersion: v1
kind: ServiceAccount
metadata:
  name: socialnetwork-elasticsearch-master
  namespace: "default"
  labels:
    app.kubernetes.io/instance: socialnetwork
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: elasticsearch
    app.kubernetes.io/version: 8.13.2
    helm.sh/chart: elasticsearch-20.0.4
    app.kubernetes.io/component: master
automountServiceAccountToken: false
---
# Source: social-network/charts/jaeger/templates/agent-sa.yaml
apiVersion: v1
kind: ServiceAccount
metadata:
  name: jaeger-agent
  labels:
    helm.sh/chart: jaeger-3.3.0
    app.kubernetes.io/name: jaeger
    app.kubernetes.io/instance: socialnetwork
    app.kubernetes.io/version: "1.53.0"
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/component: agent
automountServiceAccountToken: false
---
# Source: social-network/charts/jaeger/templates/collector-sa.yaml
apiVersion: v1
kind: ServiceAccount
metadata:
  name: jaeger-collector
  labels:
    helm.sh/chart: jaeger-3.3.0
    app.kubernetes.io/name: jaeger
    app.kubernetes.io/instance: socialnetwork
    app.kubernetes.io/version: "1.53.0"
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/component: collector
automountServiceAccountToken: false
---
# Source: social-network/charts/jaeger/templates/query-sa.yaml
apiVersion: v1
kind: ServiceAccount
metadata:
  name: jaeger-query
  labels:
    helm.sh/chart: jaeger-3.3.0
    app.kubernetes.io/name: jaeger
    app.kubernetes.io/instance: socialnetwork
    app.kubernetes.io/version: "1.53.0"
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/component: query
automountServiceAccountToken: false
---
# Source: social-network/charts/compose-post-service/templates/configmap.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: compose-post-service
  labels:
    socialnetwork/service: compose-post-service
data:
  service-config.json: |    
    {
        "secret": "secret",
        "social-graph-service": {
          "addr": "social-graph-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "social-graph-mongodb": {
          "addr": "social-graph-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "social-graph-redis": {
          "addr": "social-graph-redis",
          "port": 6379,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "use_cluster": 0,
          "use_replica": 0
        },
        "write-home-timeline-service": {
          "addr": "write-home-timeline-service",
          "port": 9090,
          "workers": 32,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "write-home-timeline-rabbitmq": {
          "addr": "write-home-timeline-rabbitmq",
          "port": 5672,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "home-timeline-redis": {
          "addr": "home-timeline-redis",
          "port": 6379,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "use_cluster": 0,
          "use_replica": 0
        },
        "compose-post-service": {
          "addr": "compose-post-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "compose-post-redis": {
          "addr": "compose-post-redis",
          "port": 6379,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "use_cluster": 0,
          "use_replica": 0
        },
        "user-timeline-service": {
          "addr": "user-timeline-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "user-timeline-mongodb": {
          "addr": "user-timeline-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "user-timeline-redis": {
          "addr": "user-timeline-redis",
          "port": 6379,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "use_cluster": 0,
          "use_replica": 0
        },
        "post-storage-service": {
          "addr": "post-storage-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "post-storage-mongodb": {
          "addr": "post-storage-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "post-storage-memcached": {
          "addr": "post-storage-memcached",
          "port": 11211,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "binary_protocol": 1
        },
        "unique-id-service": {
          "addr": "unique-id-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "netif": "eth0"
        },
        "media-service": {
          "addr": "media-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "media-mongodb": {
          "addr": "media-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "media-memcached": {
          "addr": "media-memcached",
          "port": 11211,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "binary_protocol": 1
        },
        "media-frontend": {
          "addr": "media-frontend",
          "port": 8081,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "text-service": {
          "addr": "text-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "user-mention-service": {
          "addr": "user-mention-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "url-shorten-service": {
          "addr": "url-shorten-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "url-shorten-memcached": {
          "addr": "url-shorten-memcached",
          "port": 11211,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "binary_protocol": 1
        },
        "url-shorten-mongodb": {
          "addr": "url-shorten-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "user-service": {
          "addr": "user-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "netif": "eth0"
        },
        "user-memcached": {
          "addr": "user-memcached",
          "port": 11211,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "binary_protocol": 1
        },
        "user-mongodb": {
          "addr": "user-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "home-timeline-service": {
          "addr": "home-timeline-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "ssl": {
          "enabled": false,
          "caPath": "/keys/CA.pem",
          "ciphers": "ALL:!ADH:!LOW:!EXP:!MD5:@STRENGTH",
          "serverKeyPath": "/keys/server.key",
          "serverCertPath": "/keys/server.crt"
        },
        "redis-primary": {
          "keepalive_ms": 10000,
          "addr": "redis-master",
          "timeout_ms": 10000,
          "port": 6379,
          "connections": 512
        },
        "redis-replica": {
          "keepalive_ms": 10000,
          "addr": "redis-replicas",
          "timeout_ms": 10000,
          "port": 6379,
          "connections": 512
        }
      }
  jaeger-config.yml: |    
    disabled: false
    reporter:
      logSpans: true
      localAgentHostPort: "jaeger-agent:6831"
      queueSize: 100
      bufferFlushInterval: 10
    sampler:
      type: "const"
      param: 1
---
# Source: social-network/charts/home-timeline-redis/templates/configmap.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: home-timeline-redis
  labels:
    socialnetwork/service: home-timeline-redis
data:
  redis.conf: |    
    io-threads 8
    io-threads-do-reads yes
    port 6379
    tls-port 0
    
    tls-cert-file /keys/server.crt
    tls-key-file /keys/server.key
    
    tls-auth-clients no
---
# Source: social-network/charts/home-timeline-service/templates/configmap.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: home-timeline-service
  labels:
    socialnetwork/service: home-timeline-service
data:
  service-config.json: |    
    {
        "secret": "secret",
        "social-graph-service": {
          "addr": "social-graph-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "social-graph-mongodb": {
          "addr": "social-graph-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "social-graph-redis": {
          "addr": "social-graph-redis",
          "port": 6379,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "use_cluster": 0,
          "use_replica": 0
        },
        "write-home-timeline-service": {
          "addr": "write-home-timeline-service",
          "port": 9090,
          "workers": 32,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "write-home-timeline-rabbitmq": {
          "addr": "write-home-timeline-rabbitmq",
          "port": 5672,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "home-timeline-redis": {
          "addr": "home-timeline-redis",
          "port": 6379,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "use_cluster": 0,
          "use_replica": 0
        },
        "compose-post-service": {
          "addr": "compose-post-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "compose-post-redis": {
          "addr": "compose-post-redis",
          "port": 6379,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "use_cluster": 0,
          "use_replica": 0
        },
        "user-timeline-service": {
          "addr": "user-timeline-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "user-timeline-mongodb": {
          "addr": "user-timeline-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "user-timeline-redis": {
          "addr": "user-timeline-redis",
          "port": 6379,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "use_cluster": 0,
          "use_replica": 0
        },
        "post-storage-service": {
          "addr": "post-storage-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "post-storage-mongodb": {
          "addr": "post-storage-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "post-storage-memcached": {
          "addr": "post-storage-memcached",
          "port": 11211,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "binary_protocol": 1
        },
        "unique-id-service": {
          "addr": "unique-id-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "netif": "eth0"
        },
        "media-service": {
          "addr": "media-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "media-mongodb": {
          "addr": "media-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "media-memcached": {
          "addr": "media-memcached",
          "port": 11211,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "binary_protocol": 1
        },
        "media-frontend": {
          "addr": "media-frontend",
          "port": 8081,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "text-service": {
          "addr": "text-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "user-mention-service": {
          "addr": "user-mention-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "url-shorten-service": {
          "addr": "url-shorten-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "url-shorten-memcached": {
          "addr": "url-shorten-memcached",
          "port": 11211,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "binary_protocol": 1
        },
        "url-shorten-mongodb": {
          "addr": "url-shorten-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "user-service": {
          "addr": "user-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "netif": "eth0"
        },
        "user-memcached": {
          "addr": "user-memcached",
          "port": 11211,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "binary_protocol": 1
        },
        "user-mongodb": {
          "addr": "user-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "home-timeline-service": {
          "addr": "home-timeline-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "ssl": {
          "enabled": false,
          "caPath": "/keys/CA.pem",
          "ciphers": "ALL:!ADH:!LOW:!EXP:!MD5:@STRENGTH",
          "serverKeyPath": "/keys/server.key",
          "serverCertPath": "/keys/server.crt"
        },
        "redis-primary": {
          "keepalive_ms": 10000,
          "addr": "redis-master",
          "timeout_ms": 10000,
          "port": 6379,
          "connections": 512
        },
        "redis-replica": {
          "keepalive_ms": 10000,
          "addr": "redis-replicas",
          "timeout_ms": 10000,
          "port": 6379,
          "connections": 512
        }
      }
  jaeger-config.yml: |    
    disabled: false
    reporter:
      logSpans: true
      localAgentHostPort: "jaeger-agent:6831"
      queueSize: 100
      bufferFlushInterval: 10
    sampler:
      type: "const"
      param: 1
---
# Source: social-network/charts/media-frontend/templates/configmap.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: media-frontend
  labels:
    socialnetwork/service: media-frontend
data:
  nginx.conf: |    
    # Checklist: Make sure that worker_processes == #cores you gave to
    # nginx process
    worker_processes  16;
    
    # error_log  logs/error.log;
    
    # Checklist: Make sure that worker_connections * worker_processes
    # is greater than the total connections between the client and Nginx.
    events {
      worker_connections  1024;
    }
    
    env fqdn_suffix;
    
    http {
      include       mime.types;
      default_type  application/octet-stream;
    
      log_format main '$remote_addr - $remote_user [$time_local] "$request"'
                      '$status $body_bytes_sent "$http_referer" '
                      '"$http_user_agent" "$http_x_forwarded_for"';
      # access_log  logs/access.log  main;
    
      sendfile        on;
      tcp_nopush      on;
      tcp_nodelay     on;
    
      # Checklist: Make sure the keepalive_timeout is greateer than
      # the duration of your experiment and keepalive_requests
      # is greateer than the total number of requests sent from
      # the workload generator
      keepalive_timeout  120s;
      keepalive_requests 100000;
    
      # Docker default hostname resolver
      resolver kube-dns.kube-system.svc.cluster.local valid=10s ipv6=off;
    
      lua_package_path '/usr/local/openresty/nginx/lua-scripts/?.lua;/usr/local/openresty/luajit/share/lua/5.1/?.lua;;';
    
      lua_shared_dict config 32k;
    
      init_by_lua_block {
        local upload = require "resty.upload"
        local memcached = require "resty.memcached"
        local mongo = require "resty-mongol"
      }
    
      server {
    
        # Checklist: Set up the port that nginx listens to.
        listen       8080 reuseport;
        server_name  localhost;
    
        # Checklist: Turn of the access_log and error_log if you
        # don't need them.
        access_log  off;
        # error_log off;
    
        client_max_body_size 100M;
        client_body_buffer_size 100M;
    
        # Checklist: Make sure that the location here is consistent
        # with the location you specified in wrk2.
        location /upload-media {
              if ($request_method = 'OPTIONS') {
                add_header 'Access-Control-Allow-Origin' '*';
                add_header 'Access-Control-Allow-Methods' 'GET, POST, OPTIONS';
                add_header 'Access-Control-Allow-Headers' 'DNT,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Range';
                add_header 'Access-Control-Max-Age' 1728000;
                add_header 'Content-Type' 'text/plain; charset=utf-8';
                add_header 'Content-Length' 0;
                return 204;
              }
              if ($request_method = 'POST') {
                add_header 'Access-Control-Allow-Origin' '*';
                add_header 'Access-Control-Allow-Methods' 'GET, POST, OPTIONS';
                add_header 'Access-Control-Allow-Headers' 'DNT,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Range';
                add_header 'Access-Control-Expose-Headers' 'Content-Length,Content-Range';
              }
              if ($request_method = 'GET') {
                add_header 'Access-Control-Allow-Origin' '*';
                add_header 'Access-Control-Allow-Methods' 'GET, POST, OPTIONS';
                add_header 'Access-Control-Allow-Headers' 'DNT,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Range';
                add_header 'Access-Control-Expose-Headers' 'Content-Length,Content-Range';
              }
          content_by_lua '
            local client = require "upload-media"
            client.UploadMedia();
          ';
        }
    
        # Checklist: Make sure that the location here is consistent
        # with the location you specified in wrk2.
        location /get-media {
              if ($request_method = 'OPTIONS') {
                add_header 'Access-Control-Allow-Origin' '*';
                add_header 'Access-Control-Allow-Methods' 'GET, POST, OPTIONS';
                add_header 'Access-Control-Allow-Headers' 'DNT,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Range';
                add_header 'Access-Control-Max-Age' 1728000;
                add_header 'Content-Type' 'text/plain; charset=utf-8';
                add_header 'Content-Length' 0;
                return 204;
              }
              if ($request_method = 'POST') {
                add_header 'Access-Control-Allow-Origin' '*';
                add_header 'Access-Control-Allow-Methods' 'GET, POST, OPTIONS';
                add_header 'Access-Control-Allow-Headers' 'DNT,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Range';
                add_header 'Access-Control-Expose-Headers' 'Content-Length,Content-Range';
              }
              if ($request_method = 'GET') {
                add_header 'Access-Control-Allow-Origin' '*';
                add_header 'Access-Control-Allow-Methods' 'GET, POST, OPTIONS';
                add_header 'Access-Control-Allow-Headers' 'DNT,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Range';
                add_header 'Access-Control-Expose-Headers' 'Content-Length,Content-Range';
              }
          content_by_lua '
            local client = require "get-media"
            client.GetMedia();
          ';
        }
    
      }
    }
  service-config.json: |    
    {
        "secret": "secret",
        "social-graph-service": {
          "addr": "social-graph-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "social-graph-mongodb": {
          "addr": "social-graph-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "social-graph-redis": {
          "addr": "social-graph-redis",
          "port": 6379,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "use_cluster": 0,
          "use_replica": 0
        },
        "write-home-timeline-service": {
          "addr": "write-home-timeline-service",
          "port": 9090,
          "workers": 32,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "write-home-timeline-rabbitmq": {
          "addr": "write-home-timeline-rabbitmq",
          "port": 5672,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "home-timeline-redis": {
          "addr": "home-timeline-redis",
          "port": 6379,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "use_cluster": 0,
          "use_replica": 0
        },
        "compose-post-service": {
          "addr": "compose-post-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "compose-post-redis": {
          "addr": "compose-post-redis",
          "port": 6379,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "use_cluster": 0,
          "use_replica": 0
        },
        "user-timeline-service": {
          "addr": "user-timeline-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "user-timeline-mongodb": {
          "addr": "user-timeline-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "user-timeline-redis": {
          "addr": "user-timeline-redis",
          "port": 6379,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "use_cluster": 0,
          "use_replica": 0
        },
        "post-storage-service": {
          "addr": "post-storage-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "post-storage-mongodb": {
          "addr": "post-storage-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "post-storage-memcached": {
          "addr": "post-storage-memcached",
          "port": 11211,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "binary_protocol": 1
        },
        "unique-id-service": {
          "addr": "unique-id-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "netif": "eth0"
        },
        "media-service": {
          "addr": "media-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "media-mongodb": {
          "addr": "media-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "media-memcached": {
          "addr": "media-memcached",
          "port": 11211,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "binary_protocol": 1
        },
        "media-frontend": {
          "addr": "media-frontend",
          "port": 8081,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "text-service": {
          "addr": "text-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "user-mention-service": {
          "addr": "user-mention-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "url-shorten-service": {
          "addr": "url-shorten-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "url-shorten-memcached": {
          "addr": "url-shorten-memcached",
          "port": 11211,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "binary_protocol": 1
        },
        "url-shorten-mongodb": {
          "addr": "url-shorten-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "user-service": {
          "addr": "user-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "netif": "eth0"
        },
        "user-memcached": {
          "addr": "user-memcached",
          "port": 11211,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "binary_protocol": 1
        },
        "user-mongodb": {
          "addr": "user-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "home-timeline-service": {
          "addr": "home-timeline-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "ssl": {
          "enabled": false,
          "caPath": "/keys/CA.pem",
          "ciphers": "ALL:!ADH:!LOW:!EXP:!MD5:@STRENGTH",
          "serverKeyPath": "/keys/server.key",
          "serverCertPath": "/keys/server.crt"
        },
        "redis-primary": {
          "keepalive_ms": 10000,
          "addr": "redis-master",
          "timeout_ms": 10000,
          "port": 6379,
          "connections": 512
        },
        "redis-replica": {
          "keepalive_ms": 10000,
          "addr": "redis-replicas",
          "timeout_ms": 10000,
          "port": 6379,
          "connections": 512
        }
      }
  jaeger-config.yml: |    # charts/<microservice>/configs/jaeger-config
---
# Source: social-network/charts/media-memcached/templates/configmap.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: media-memcached
  labels:
    socialnetwork/service: media-memcached
data:
  service-config.json: |    
    {
        "secret": "secret",
        "social-graph-service": {
          "addr": "social-graph-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "social-graph-mongodb": {
          "addr": "social-graph-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "social-graph-redis": {
          "addr": "social-graph-redis",
          "port": 6379,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "use_cluster": 0,
          "use_replica": 0
        },
        "write-home-timeline-service": {
          "addr": "write-home-timeline-service",
          "port": 9090,
          "workers": 32,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "write-home-timeline-rabbitmq": {
          "addr": "write-home-timeline-rabbitmq",
          "port": 5672,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "home-timeline-redis": {
          "addr": "home-timeline-redis",
          "port": 6379,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "use_cluster": 0,
          "use_replica": 0
        },
        "compose-post-service": {
          "addr": "compose-post-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "compose-post-redis": {
          "addr": "compose-post-redis",
          "port": 6379,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "use_cluster": 0,
          "use_replica": 0
        },
        "user-timeline-service": {
          "addr": "user-timeline-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "user-timeline-mongodb": {
          "addr": "user-timeline-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "user-timeline-redis": {
          "addr": "user-timeline-redis",
          "port": 6379,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "use_cluster": 0,
          "use_replica": 0
        },
        "post-storage-service": {
          "addr": "post-storage-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "post-storage-mongodb": {
          "addr": "post-storage-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "post-storage-memcached": {
          "addr": "post-storage-memcached",
          "port": 11211,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "binary_protocol": 1
        },
        "unique-id-service": {
          "addr": "unique-id-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "netif": "eth0"
        },
        "media-service": {
          "addr": "media-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "media-mongodb": {
          "addr": "media-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "media-memcached": {
          "addr": "media-memcached",
          "port": 11211,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "binary_protocol": 1
        },
        "media-frontend": {
          "addr": "media-frontend",
          "port": 8081,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "text-service": {
          "addr": "text-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "user-mention-service": {
          "addr": "user-mention-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "url-shorten-service": {
          "addr": "url-shorten-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "url-shorten-memcached": {
          "addr": "url-shorten-memcached",
          "port": 11211,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "binary_protocol": 1
        },
        "url-shorten-mongodb": {
          "addr": "url-shorten-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "user-service": {
          "addr": "user-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "netif": "eth0"
        },
        "user-memcached": {
          "addr": "user-memcached",
          "port": 11211,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "binary_protocol": 1
        },
        "user-mongodb": {
          "addr": "user-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "home-timeline-service": {
          "addr": "home-timeline-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "ssl": {
          "enabled": false,
          "caPath": "/keys/CA.pem",
          "ciphers": "ALL:!ADH:!LOW:!EXP:!MD5:@STRENGTH",
          "serverKeyPath": "/keys/server.key",
          "serverCertPath": "/keys/server.crt"
        },
        "redis-primary": {
          "keepalive_ms": 10000,
          "addr": "redis-master",
          "timeout_ms": 10000,
          "port": 6379,
          "connections": 512
        },
        "redis-replica": {
          "keepalive_ms": 10000,
          "addr": "redis-replicas",
          "timeout_ms": 10000,
          "port": 6379,
          "connections": 512
        }
      }
  jaeger-config.yml: |    
    disabled: false
    reporter:
      logSpans: true
      localAgentHostPort: "jaeger-agent:6831"
      queueSize: 100
      bufferFlushInterval: 10
    sampler:
      type: "const"
      param: 1
---
# Source: social-network/charts/media-mongodb/templates/configmap.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: media-mongodb
  labels:
    socialnetwork/service: media-mongodb
data:
  mongod.conf: |    
    net:
      tls:
        mode: disabled
---
# Source: social-network/charts/media-service/templates/configmap.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: media-service
  labels:
    socialnetwork/service: media-service
data:
  service-config.json: |    
    {
        "secret": "secret",
        "social-graph-service": {
          "addr": "social-graph-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "social-graph-mongodb": {
          "addr": "social-graph-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "social-graph-redis": {
          "addr": "social-graph-redis",
          "port": 6379,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "use_cluster": 0,
          "use_replica": 0
        },
        "write-home-timeline-service": {
          "addr": "write-home-timeline-service",
          "port": 9090,
          "workers": 32,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "write-home-timeline-rabbitmq": {
          "addr": "write-home-timeline-rabbitmq",
          "port": 5672,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "home-timeline-redis": {
          "addr": "home-timeline-redis",
          "port": 6379,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "use_cluster": 0,
          "use_replica": 0
        },
        "compose-post-service": {
          "addr": "compose-post-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "compose-post-redis": {
          "addr": "compose-post-redis",
          "port": 6379,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "use_cluster": 0,
          "use_replica": 0
        },
        "user-timeline-service": {
          "addr": "user-timeline-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "user-timeline-mongodb": {
          "addr": "user-timeline-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "user-timeline-redis": {
          "addr": "user-timeline-redis",
          "port": 6379,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "use_cluster": 0,
          "use_replica": 0
        },
        "post-storage-service": {
          "addr": "post-storage-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "post-storage-mongodb": {
          "addr": "post-storage-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "post-storage-memcached": {
          "addr": "post-storage-memcached",
          "port": 11211,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "binary_protocol": 1
        },
        "unique-id-service": {
          "addr": "unique-id-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "netif": "eth0"
        },
        "media-service": {
          "addr": "media-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "media-mongodb": {
          "addr": "media-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "media-memcached": {
          "addr": "media-memcached",
          "port": 11211,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "binary_protocol": 1
        },
        "media-frontend": {
          "addr": "media-frontend",
          "port": 8081,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "text-service": {
          "addr": "text-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "user-mention-service": {
          "addr": "user-mention-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "url-shorten-service": {
          "addr": "url-shorten-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "url-shorten-memcached": {
          "addr": "url-shorten-memcached",
          "port": 11211,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "binary_protocol": 1
        },
        "url-shorten-mongodb": {
          "addr": "url-shorten-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "user-service": {
          "addr": "user-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "netif": "eth0"
        },
        "user-memcached": {
          "addr": "user-memcached",
          "port": 11211,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "binary_protocol": 1
        },
        "user-mongodb": {
          "addr": "user-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "home-timeline-service": {
          "addr": "home-timeline-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "ssl": {
          "enabled": false,
          "caPath": "/keys/CA.pem",
          "ciphers": "ALL:!ADH:!LOW:!EXP:!MD5:@STRENGTH",
          "serverKeyPath": "/keys/server.key",
          "serverCertPath": "/keys/server.crt"
        },
        "redis-primary": {
          "keepalive_ms": 10000,
          "addr": "redis-master",
          "timeout_ms": 10000,
          "port": 6379,
          "connections": 512
        },
        "redis-replica": {
          "keepalive_ms": 10000,
          "addr": "redis-replicas",
          "timeout_ms": 10000,
          "port": 6379,
          "connections": 512
        }
      }
  jaeger-config.yml: |    
    disabled: false
    reporter:
      logSpans: true
      localAgentHostPort: "jaeger-agent:6831"
      queueSize: 100
      bufferFlushInterval: 10
    sampler:
      type: "const"
      param: 1
---
# Source: social-network/charts/nginx-thrift/templates/configmap.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: nginx-thrift
  labels:
    socialnetwork/service: nginx-thrift
data:
  nginx.conf: |    
    # Load the OpenTracing dynamic module.
    load_module modules/ngx_http_opentracing_module.so;
    
    # Checklist: Make sure that worker_processes == #cores you gave to
    # nginx process
    worker_processes  auto;
    
    # error_log  logs/error.log;
    
    # Checklist: Make sure that worker_connections * worker_processes
    # is greater than the total connections between the client and Nginx. 
    events {
      use epoll;
      worker_connections  1024;
    }
    
    env fqdn_suffix;
    
    http {
      # Load a vendor tracer
      opentracing on;
      # opentracing_load_tracer /usr/local/lib/libjaegertracing_plugin.so /usr/local/openresty/nginx/jaeger-config.json;
    
      include       mime.types;
      default_type  application/octet-stream;
    
      proxy_read_timeout 5000;
      proxy_connect_timeout 5000;
      proxy_send_timeout 5000;
      
      log_format main '$remote_addr - $remote_user [$time_local] "$request"'
                      '$status $body_bytes_sent "$http_referer" '
                      '"$http_user_agent" "$http_x_forwarded_for"';
      # access_log  logs/access.log  main;
    
      sendfile        on;
      tcp_nopush      on;
      tcp_nodelay     on;
    
      # Checklist: Make sure the keepalive_timeout is greateer than
      # the duration of your experiment and keepalive_requests
      # is greateer than the total number of requests sent from
      # the workload generator
      keepalive_timeout  1200s;
      keepalive_requests 100000;
    
      # Docker default hostname resolver. Set valid timeout to prevent unlimited
      # ttl for resolver caching.
      # resolver 127.0.0.11 valid=10s ipv6=off;
      resolver kube-dns.kube-system.svc.cluster.local valid=10s ipv6=off;
    
      lua_package_path '/usr/local/openresty/nginx/lua-scripts/?.lua;/usr/local/openresty/luajit/share/lua/5.1/?.lua;;';
    
      lua_shared_dict config 32k;
    
      init_by_lua_block {
        local bridge_tracer = require "opentracing_bridge_tracer"
        local GenericObjectPool = require "GenericObjectPool"
        local ngx = ngx
        local jwt = require "resty.jwt"
        local cjson = require 'cjson'
    
        local social_network_UserTimelineService = require 'social_network_UserTimelineService'
        local UserTimelineServiceClient = social_network_UserTimelineService.social_network_UserTimelineService
        local social_network_SocialGraphService = require 'social_network_SocialGraphService'
        local SocialGraphServiceClient = social_network_SocialGraphService.SocialGraphServiceClient
        local social_network_ComposePostService = require 'social_network_ComposePostService'
        local ComposePostServiceClient = social_network_ComposePostService.ComposePostServiceClient
        local social_network_UserService = require 'social_network_UserService'
        local UserServiceClient = social_network_UserService.UserServiceClient
    
    
        local config = ngx.shared.config;
        config:set("secret", "secret")
        config:set("cookie_ttl", 3600 * 24)
        config:set("ssl", false)
      }
    
      server {
    
        # Checklist: Set up the port that nginx listens to.
        listen       8080 reuseport;
        server_name  localhost;
    
        # Checklist: Turn of the access_log and error_log if you
        # don't need them.
        access_log  off;
        # error_log off;
    
        lua_need_request_body on;
    
        # Used when SSL enabled
        lua_ssl_trusted_certificate /keys/CA.pem;
        lua_ssl_ciphers ALL:!ADH:!LOW:!EXP:!MD5:@STRENGTH;
    
        # Checklist: Make sure that the location here is consistent
        # with the location you specified in wrk2.
        location /api/user/register {
              if ($request_method = 'OPTIONS') {
                add_header 'Access-Control-Allow-Origin' '*';
                add_header 'Access-Control-Allow-Methods' 'GET, POST, OPTIONS';
                add_header 'Access-Control-Allow-Headers' 'DNT,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Range';
                add_header 'Access-Control-Max-Age' 1728000;
                add_header 'Content-Type' 'text/plain; charset=utf-8';
                add_header 'Content-Length' 0;
                return 204;
              }
              if ($request_method = 'POST') {
                add_header 'Access-Control-Allow-Origin' '*';
                add_header 'Access-Control-Allow-Methods' 'GET, POST, OPTIONS';
                add_header 'Access-Control-Allow-Headers' 'DNT,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Range';
                add_header 'Access-Control-Expose-Headers' 'Content-Length,Content-Range';
              }
              if ($request_method = 'GET') {
                add_header 'Access-Control-Allow-Origin' '*';
                add_header 'Access-Control-Allow-Methods' 'GET, POST, OPTIONS';
                add_header 'Access-Control-Allow-Headers' 'DNT,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Range';
                add_header 'Access-Control-Expose-Headers' 'Content-Length,Content-Range';
              }
          content_by_lua '
              local client = require "api/user/register"
              client.RegisterUser();
          ';
        }
    
        location /api/user/follow {
              if ($request_method = 'OPTIONS') {
                add_header 'Access-Control-Allow-Origin' '*';
                add_header 'Access-Control-Allow-Methods' 'GET, POST, OPTIONS';
                add_header 'Access-Control-Allow-Headers' 'DNT,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Range';
                add_header 'Access-Control-Max-Age' 1728000;
                add_header 'Content-Type' 'text/plain; charset=utf-8';
                add_header 'Content-Length' 0;
                return 204;
              }
              if ($request_method = 'POST') {
                add_header 'Access-Control-Allow-Origin' '*';
                add_header 'Access-Control-Allow-Methods' 'GET, POST, OPTIONS';
                add_header 'Access-Control-Allow-Headers' 'DNT,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Range';
                add_header 'Access-Control-Expose-Headers' 'Content-Length,Content-Range';
              }
              if ($request_method = 'GET') {
                add_header 'Access-Control-Allow-Origin' '*';
                add_header 'Access-Control-Allow-Methods' 'GET, POST, OPTIONS';
                add_header 'Access-Control-Allow-Headers' 'DNT,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Range';
                add_header 'Access-Control-Expose-Headers' 'Content-Length,Content-Range';
              }
          content_by_lua '
              local client = require "api/user/follow"
              client.Follow();
          ';
        }
    
        location /api/user/unfollow {
              if ($request_method = 'OPTIONS') {
                add_header 'Access-Control-Allow-Origin' '*';
                add_header 'Access-Control-Allow-Methods' 'GET, POST, OPTIONS';
                add_header 'Access-Control-Allow-Headers' 'DNT,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Range';
                add_header 'Access-Control-Max-Age' 1728000;
                add_header 'Content-Type' 'text/plain; charset=utf-8';
                add_header 'Content-Length' 0;
                return 204;
              }
              if ($request_method = 'POST') {
                add_header 'Access-Control-Allow-Origin' '*';
                add_header 'Access-Control-Allow-Methods' 'GET, POST, OPTIONS';
                add_header 'Access-Control-Allow-Headers' 'DNT,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Range';
                add_header 'Access-Control-Expose-Headers' 'Content-Length,Content-Range';
              }
              if ($request_method = 'GET') {
                add_header 'Access-Control-Allow-Origin' '*';
                add_header 'Access-Control-Allow-Methods' 'GET, POST, OPTIONS';
                add_header 'Access-Control-Allow-Headers' 'DNT,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Range';
                add_header 'Access-Control-Expose-Headers' 'Content-Length,Content-Range';
              }
          content_by_lua '
              local client = require "api/user/unfollow"
              client.Unfollow();
          ';
        }
    
        location /api/user/login {
              if ($request_method = 'OPTIONS') {
                add_header 'Access-Control-Allow-Origin' '*';
                add_header 'Access-Control-Allow-Methods' 'GET, POST, OPTIONS';
                add_header 'Access-Control-Allow-Headers' 'DNT,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Range';
                add_header 'Access-Control-Max-Age' 1728000;
                add_header 'Content-Type' 'text/plain; charset=utf-8';
                add_header 'Content-Length' 0;
                return 204;
              }
              if ($request_method = 'POST') {
                add_header 'Access-Control-Allow-Origin' '*';
                add_header 'Access-Control-Allow-Methods' 'GET, POST, OPTIONS';
                add_header 'Access-Control-Allow-Headers' 'DNT,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Range';
                add_header 'Access-Control-Expose-Headers' 'Content-Length,Content-Range';
              }
              if ($request_method = 'GET') {
                add_header 'Access-Control-Allow-Origin' '*';
                add_header 'Access-Control-Allow-Methods' 'GET, POST, OPTIONS';
                add_header 'Access-Control-Allow-Headers' 'DNT,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Range';
                add_header 'Access-Control-Expose-Headers' 'Content-Length,Content-Range';
              }
          content_by_lua '
              local client = require "api/user/login"
              client.Login();
          ';
        }
    
        location /api/post/compose {
              if ($request_method = 'OPTIONS') {
                add_header 'Access-Control-Allow-Origin' '*';
                add_header 'Access-Control-Allow-Methods' 'GET, POST, OPTIONS';
                add_header 'Access-Control-Allow-Headers' 'DNT,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Range';
                add_header 'Access-Control-Max-Age' 1728000;
                add_header 'Content-Type' 'text/plain; charset=utf-8';
                add_header 'Content-Length' 0;
                return 204;
              }
              if ($request_method = 'POST') {
                add_header 'Access-Control-Allow-Origin' '*';
                add_header 'Access-Control-Allow-Methods' 'GET, POST, OPTIONS';
                add_header 'Access-Control-Allow-Headers' 'DNT,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Range';
                add_header 'Access-Control-Expose-Headers' 'Content-Length,Content-Range';
              }
              if ($request_method = 'GET') {
                add_header 'Access-Control-Allow-Origin' '*';
                add_header 'Access-Control-Allow-Methods' 'GET, POST, OPTIONS';
                add_header 'Access-Control-Allow-Headers' 'DNT,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Range';
                add_header 'Access-Control-Expose-Headers' 'Content-Length,Content-Range';
              }
          content_by_lua '
              local client = require "api/post/compose"
              client.ComposePost();
          ';
        }
    
        location /api/user-timeline/read {
              if ($request_method = 'OPTIONS') {
                add_header 'Access-Control-Allow-Origin' '*';
                add_header 'Access-Control-Allow-Methods' 'GET, POST, OPTIONS';
                add_header 'Access-Control-Allow-Headers' 'DNT,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Range';
                add_header 'Access-Control-Max-Age' 1728000;
                add_header 'Content-Type' 'text/plain; charset=utf-8';
                add_header 'Content-Length' 0;
                return 204;
              }
              if ($request_method = 'POST') {
                add_header 'Access-Control-Allow-Origin' '*';
                add_header 'Access-Control-Allow-Methods' 'GET, POST, OPTIONS';
                add_header 'Access-Control-Allow-Headers' 'DNT,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Range';
                add_header 'Access-Control-Expose-Headers' 'Content-Length,Content-Range';
              }
              if ($request_method = 'GET') {
                add_header 'Access-Control-Allow-Origin' '*';
                add_header 'Access-Control-Allow-Methods' 'GET, POST, OPTIONS';
                add_header 'Access-Control-Allow-Headers' 'DNT,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Range';
                add_header 'Access-Control-Expose-Headers' 'Content-Length,Content-Range';
              }
          content_by_lua '
              local client = require "api/user-timeline/read"
              client.ReadUserTimeline();
          ';
        }
    
        location /api/home-timeline/read {
                if ($request_method = 'OPTIONS') {
                  add_header 'Access-Control-Allow-Origin' '*';
                  add_header 'Access-Control-Allow-Methods' 'GET, POST, OPTIONS';
                  add_header 'Access-Control-Allow-Headers' 'DNT,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Range';
                  add_header 'Access-Control-Max-Age' 1728000;
                  add_header 'Content-Type' 'text/plain; charset=utf-8';
                  add_header 'Content-Length' 0;
                  return 204;
                }
                if ($request_method = 'POST') {
                  add_header 'Access-Control-Allow-Origin' '*';
                  add_header 'Access-Control-Allow-Methods' 'GET, POST, OPTIONS';
                  add_header 'Access-Control-Allow-Headers' 'DNT,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Range';
                  add_header 'Access-Control-Expose-Headers' 'Content-Length,Content-Range';
                }
                if ($request_method = 'GET') {
                  add_header 'Access-Control-Allow-Origin' '*';
                  add_header 'Access-Control-Allow-Methods' 'GET, POST, OPTIONS';
                  add_header 'Access-Control-Allow-Headers' 'DNT,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Range';
                  add_header 'Access-Control-Expose-Headers' 'Content-Length,Content-Range';
                }
          content_by_lua '
              local client = require "api/home-timeline/read"
              client.ReadHomeTimeline();
          ';
        }
    
        # # get userinfo lua
        # location /api/user/user_info {
        #       if ($request_method = 'OPTIONS') {
        #         add_header 'Access-Control-Allow-Origin' '*';
        #         add_header 'Access-Control-Allow-Methods' 'GET, POST, OPTIONS';
        #         add_header 'Access-Control-Allow-Headers' 'DNT,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Range';
        #         add_header 'Access-Control-Max-Age' 1728000;
        #         add_header 'Content-Type' 'text/plain; charset=utf-8';
        #         add_header 'Content-Length' 0;
        #         return 204;
        #       }
        #       if ($request_method = 'POST') {
        #         add_header 'Access-Control-Allow-Origin' '*';
        #         add_header 'Access-Control-Allow-Methods' 'GET, POST, OPTIONS';
        #         add_header 'Access-Control-Allow-Headers' 'DNT,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Range';
        #         add_header 'Access-Control-Expose-Headers' 'Content-Length,Content-Range';
        #       }
        #       if ($request_method = 'GET') {
        #         add_header 'Access-Control-Allow-Origin' '*';
        #         add_header 'Access-Control-Allow-Methods' 'GET, POST, OPTIONS';
        #         add_header 'Access-Control-Allow-Headers' 'DNT,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Range';
        #         add_header 'Access-Control-Expose-Headers' 'Content-Length,Content-Range';
        #       }
        #   content_by_lua '
        #       local client = require "api/user/user_info"
        #       client.UserInfo();
        #   ';
        # }
        # get follower lua
        location /api/user/get_follower {
              if ($request_method = 'OPTIONS') {
                add_header 'Access-Control-Allow-Origin' '*';
                add_header 'Access-Control-Allow-Methods' 'GET, POST, OPTIONS';
                add_header 'Access-Control-Allow-Headers' 'DNT,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Range';
                add_header 'Access-Control-Max-Age' 1728000;
                add_header 'Content-Type' 'text/plain; charset=utf-8';
                add_header 'Content-Length' 0;
                return 204;
              }
              if ($request_method = 'POST') {
                add_header 'Access-Control-Allow-Origin' '*';
                add_header 'Access-Control-Allow-Methods' 'GET, POST, OPTIONS';
                add_header 'Access-Control-Allow-Headers' 'DNT,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Range';
                add_header 'Access-Control-Expose-Headers' 'Content-Length,Content-Range';
              }
              if ($request_method = 'GET') {
                add_header 'Access-Control-Allow-Origin' '*';
                add_header 'Access-Control-Allow-Methods' 'GET, POST, OPTIONS';
                add_header 'Access-Control-Allow-Headers' 'DNT,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Range';
                add_header 'Access-Control-Expose-Headers' 'Content-Length,Content-Range';
              }
          content_by_lua '
              local client = require "api/user/get_follower"
              client.GetFollower();
          ';
        }
    
        # get followee lua
        location /api/user/get_followee {
              if ($request_method = 'OPTIONS') {
                add_header 'Access-Control-Allow-Origin' '*';
                add_header 'Access-Control-Allow-Methods' 'GET, POST, OPTIONS';
                add_header 'Access-Control-Allow-Headers' 'DNT,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Range';
                add_header 'Access-Control-Max-Age' 1728000;
                add_header 'Content-Type' 'text/plain; charset=utf-8';
                add_header 'Content-Length' 0;
                return 204;
              }
              if ($request_method = 'POST') {
                add_header 'Access-Control-Allow-Origin' '*';
                add_header 'Access-Control-Allow-Methods' 'GET, POST, OPTIONS';
                add_header 'Access-Control-Allow-Headers' 'DNT,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Range';
                add_header 'Access-Control-Expose-Headers' 'Content-Length,Content-Range';
              }
              if ($request_method = 'GET') {
                add_header 'Access-Control-Allow-Origin' '*';
                add_header 'Access-Control-Allow-Methods' 'GET, POST, OPTIONS';
                add_header 'Access-Control-Allow-Headers' 'DNT,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Range';
                add_header 'Access-Control-Expose-Headers' 'Content-Length,Content-Range';
              }
          content_by_lua '
              local client = require "api/user/get_followee"
              client.GetFollowee();
          ';
        }
        location / {
          if ($request_method = 'OPTIONS') {
            add_header 'Access-Control-Allow-Origin' '*';
            add_header 'Access-Control-Allow-Methods' 'GET, POST, OPTIONS';
            add_header 'Access-Control-Allow-Headers' 'DNT,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Range';
            add_header 'Access-Control-Max-Age' 1728000;
            add_header 'Content-Type' 'text/plain; charset=utf-8';
            add_header 'Content-Length' 0;
            return 204;
          }
          if ($request_method = 'POST') {
            add_header 'Access-Control-Allow-Origin' '*';
            add_header 'Access-Control-Allow-Methods' 'GET, POST, OPTIONS';
            add_header 'Access-Control-Allow-Headers' 'DNT,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Range';
            add_header 'Access-Control-Expose-Headers' 'Content-Length,Content-Range';
          }
          if ($request_method = 'GET') {
            add_header 'Access-Control-Allow-Origin' '*';
            add_header 'Access-Control-Allow-Methods' 'GET, POST, OPTIONS';
            add_header 'Access-Control-Allow-Headers' 'DNT,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Range';
            add_header 'Access-Control-Expose-Headers' 'Content-Length,Content-Range';
          }
          root pages;
        }
    
        location /wrk2-api/home-timeline/read {
          content_by_lua '
              local client = require "wrk2-api/home-timeline/read"
              client.ReadHomeTimeline();
          ';
        }
    
        location /wrk2-api/user-timeline/read {
          content_by_lua '
              local client = require "wrk2-api/user-timeline/read"
              client.ReadUserTimeline();
          ';
        }
    
        location /wrk2-api/post/compose {
          content_by_lua '
              local client = require "wrk2-api/post/compose"
              client.ComposePost();
          ';
        }
    
        location /wrk2-api/user/register {
          content_by_lua '
              local client = require "wrk2-api/user/register"
              client.RegisterUser();
          ';
        }
    
        location /wrk2-api/user/follow {
          content_by_lua '
              local client = require "wrk2-api/user/follow"
              client.Follow();
          ';
        }
    
        location /wrk2-api/user/unfollow {
          content_by_lua '
              local client = require "wrk2-api/user/unfollow"
              client.Unfollow();
          ';
        }
    
      }
    }
  jaeger-config.yml: |    
    disabled: false
    reporter:
      logSpans: true
      localAgentHostPort: "jaeger-agent:6831"
      queueSize: 100
      bufferFlushInterval: 10
    sampler:
      type: "const"
      param: 1
---
# Source: social-network/charts/post-storage-memcached/templates/configmap.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: post-storage-memcached
  labels:
    socialnetwork/service: post-storage-memcached
data:
  service-config.json: |    
    {
        "secret": "secret",
        "social-graph-service": {
          "addr": "social-graph-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "social-graph-mongodb": {
          "addr": "social-graph-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "social-graph-redis": {
          "addr": "social-graph-redis",
          "port": 6379,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "use_cluster": 0,
          "use_replica": 0
        },
        "write-home-timeline-service": {
          "addr": "write-home-timeline-service",
          "port": 9090,
          "workers": 32,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "write-home-timeline-rabbitmq": {
          "addr": "write-home-timeline-rabbitmq",
          "port": 5672,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "home-timeline-redis": {
          "addr": "home-timeline-redis",
          "port": 6379,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "use_cluster": 0,
          "use_replica": 0
        },
        "compose-post-service": {
          "addr": "compose-post-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "compose-post-redis": {
          "addr": "compose-post-redis",
          "port": 6379,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "use_cluster": 0,
          "use_replica": 0
        },
        "user-timeline-service": {
          "addr": "user-timeline-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "user-timeline-mongodb": {
          "addr": "user-timeline-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "user-timeline-redis": {
          "addr": "user-timeline-redis",
          "port": 6379,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "use_cluster": 0,
          "use_replica": 0
        },
        "post-storage-service": {
          "addr": "post-storage-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "post-storage-mongodb": {
          "addr": "post-storage-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "post-storage-memcached": {
          "addr": "post-storage-memcached",
          "port": 11211,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "binary_protocol": 1
        },
        "unique-id-service": {
          "addr": "unique-id-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "netif": "eth0"
        },
        "media-service": {
          "addr": "media-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "media-mongodb": {
          "addr": "media-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "media-memcached": {
          "addr": "media-memcached",
          "port": 11211,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "binary_protocol": 1
        },
        "media-frontend": {
          "addr": "media-frontend",
          "port": 8081,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "text-service": {
          "addr": "text-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "user-mention-service": {
          "addr": "user-mention-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "url-shorten-service": {
          "addr": "url-shorten-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "url-shorten-memcached": {
          "addr": "url-shorten-memcached",
          "port": 11211,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "binary_protocol": 1
        },
        "url-shorten-mongodb": {
          "addr": "url-shorten-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "user-service": {
          "addr": "user-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "netif": "eth0"
        },
        "user-memcached": {
          "addr": "user-memcached",
          "port": 11211,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "binary_protocol": 1
        },
        "user-mongodb": {
          "addr": "user-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "home-timeline-service": {
          "addr": "home-timeline-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "ssl": {
          "enabled": false,
          "caPath": "/keys/CA.pem",
          "ciphers": "ALL:!ADH:!LOW:!EXP:!MD5:@STRENGTH",
          "serverKeyPath": "/keys/server.key",
          "serverCertPath": "/keys/server.crt"
        },
        "redis-primary": {
          "keepalive_ms": 10000,
          "addr": "redis-master",
          "timeout_ms": 10000,
          "port": 6379,
          "connections": 512
        },
        "redis-replica": {
          "keepalive_ms": 10000,
          "addr": "redis-replicas",
          "timeout_ms": 10000,
          "port": 6379,
          "connections": 512
        }
      }
  jaeger-config.yml: |    
    disabled: false
    reporter:
      logSpans: true
      localAgentHostPort: "jaeger-agent:6831"
      queueSize: 100
      bufferFlushInterval: 10
    sampler:
      type: "const"
      param: 1
---
# Source: social-network/charts/post-storage-mongodb/templates/configmap.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: post-storage-mongodb
  labels:
    socialnetwork/service: post-storage-mongodb
data:
  mongod.conf: |    
    net:
      tls:
        mode: disabled
---
# Source: social-network/charts/post-storage-service/templates/configmap.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: post-storage-service
  labels:
    socialnetwork/service: post-storage-service
data:
  service-config.json: |    
    {
        "secret": "secret",
        "social-graph-service": {
          "addr": "social-graph-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "social-graph-mongodb": {
          "addr": "social-graph-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "social-graph-redis": {
          "addr": "social-graph-redis",
          "port": 6379,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "use_cluster": 0,
          "use_replica": 0
        },
        "write-home-timeline-service": {
          "addr": "write-home-timeline-service",
          "port": 9090,
          "workers": 32,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "write-home-timeline-rabbitmq": {
          "addr": "write-home-timeline-rabbitmq",
          "port": 5672,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "home-timeline-redis": {
          "addr": "home-timeline-redis",
          "port": 6379,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "use_cluster": 0,
          "use_replica": 0
        },
        "compose-post-service": {
          "addr": "compose-post-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "compose-post-redis": {
          "addr": "compose-post-redis",
          "port": 6379,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "use_cluster": 0,
          "use_replica": 0
        },
        "user-timeline-service": {
          "addr": "user-timeline-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "user-timeline-mongodb": {
          "addr": "user-timeline-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "user-timeline-redis": {
          "addr": "user-timeline-redis",
          "port": 6379,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "use_cluster": 0,
          "use_replica": 0
        },
        "post-storage-service": {
          "addr": "post-storage-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "post-storage-mongodb": {
          "addr": "post-storage-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "post-storage-memcached": {
          "addr": "post-storage-memcached",
          "port": 11211,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "binary_protocol": 1
        },
        "unique-id-service": {
          "addr": "unique-id-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "netif": "eth0"
        },
        "media-service": {
          "addr": "media-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "media-mongodb": {
          "addr": "media-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "media-memcached": {
          "addr": "media-memcached",
          "port": 11211,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "binary_protocol": 1
        },
        "media-frontend": {
          "addr": "media-frontend",
          "port": 8081,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "text-service": {
          "addr": "text-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "user-mention-service": {
          "addr": "user-mention-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "url-shorten-service": {
          "addr": "url-shorten-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "url-shorten-memcached": {
          "addr": "url-shorten-memcached",
          "port": 11211,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "binary_protocol": 1
        },
        "url-shorten-mongodb": {
          "addr": "url-shorten-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "user-service": {
          "addr": "user-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "netif": "eth0"
        },
        "user-memcached": {
          "addr": "user-memcached",
          "port": 11211,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "binary_protocol": 1
        },
        "user-mongodb": {
          "addr": "user-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "home-timeline-service": {
          "addr": "home-timeline-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "ssl": {
          "enabled": false,
          "caPath": "/keys/CA.pem",
          "ciphers": "ALL:!ADH:!LOW:!EXP:!MD5:@STRENGTH",
          "serverKeyPath": "/keys/server.key",
          "serverCertPath": "/keys/server.crt"
        },
        "redis-primary": {
          "keepalive_ms": 10000,
          "addr": "redis-master",
          "timeout_ms": 10000,
          "port": 6379,
          "connections": 512
        },
        "redis-replica": {
          "keepalive_ms": 10000,
          "addr": "redis-replicas",
          "timeout_ms": 10000,
          "port": 6379,
          "connections": 512
        }
      }
  jaeger-config.yml: |    
    disabled: false
    reporter:
      logSpans: true
      localAgentHostPort: "jaeger-agent:6831"
      queueSize: 100
      bufferFlushInterval: 10
    sampler:
      type: "const"
      param: 1
---
# Source: social-network/charts/social-graph-mongodb/templates/configmap.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: social-graph-mongodb
  labels:
    socialnetwork/service: social-graph-mongodb
data:
  mongod.conf: |    
    net:
      tls:
        mode: disabled
---
# Source: social-network/charts/social-graph-redis/templates/configmap.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: social-graph-redis
  labels:
    socialnetwork/service: social-graph-redis
data:
  redis.conf: |    
    io-threads 8
    io-threads-do-reads yes
    port 6379
    tls-port 0
    
    tls-cert-file /keys/server.crt
    tls-key-file /keys/server.key
    
    tls-auth-clients no
---
# Source: social-network/charts/social-graph-service/templates/configmap.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: social-graph-service
  labels:
    socialnetwork/service: social-graph-service
data:
  service-config.json: |    
    {
        "secret": "secret",
        "social-graph-service": {
          "addr": "social-graph-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "social-graph-mongodb": {
          "addr": "social-graph-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "social-graph-redis": {
          "addr": "social-graph-redis",
          "port": 6379,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "use_cluster": 0,
          "use_replica": 0
        },
        "write-home-timeline-service": {
          "addr": "write-home-timeline-service",
          "port": 9090,
          "workers": 32,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "write-home-timeline-rabbitmq": {
          "addr": "write-home-timeline-rabbitmq",
          "port": 5672,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "home-timeline-redis": {
          "addr": "home-timeline-redis",
          "port": 6379,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "use_cluster": 0,
          "use_replica": 0
        },
        "compose-post-service": {
          "addr": "compose-post-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "compose-post-redis": {
          "addr": "compose-post-redis",
          "port": 6379,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "use_cluster": 0,
          "use_replica": 0
        },
        "user-timeline-service": {
          "addr": "user-timeline-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "user-timeline-mongodb": {
          "addr": "user-timeline-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "user-timeline-redis": {
          "addr": "user-timeline-redis",
          "port": 6379,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "use_cluster": 0,
          "use_replica": 0
        },
        "post-storage-service": {
          "addr": "post-storage-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "post-storage-mongodb": {
          "addr": "post-storage-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "post-storage-memcached": {
          "addr": "post-storage-memcached",
          "port": 11211,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "binary_protocol": 1
        },
        "unique-id-service": {
          "addr": "unique-id-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "netif": "eth0"
        },
        "media-service": {
          "addr": "media-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "media-mongodb": {
          "addr": "media-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "media-memcached": {
          "addr": "media-memcached",
          "port": 11211,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "binary_protocol": 1
        },
        "media-frontend": {
          "addr": "media-frontend",
          "port": 8081,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "text-service": {
          "addr": "text-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "user-mention-service": {
          "addr": "user-mention-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "url-shorten-service": {
          "addr": "url-shorten-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "url-shorten-memcached": {
          "addr": "url-shorten-memcached",
          "port": 11211,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "binary_protocol": 1
        },
        "url-shorten-mongodb": {
          "addr": "url-shorten-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "user-service": {
          "addr": "user-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "netif": "eth0"
        },
        "user-memcached": {
          "addr": "user-memcached",
          "port": 11211,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "binary_protocol": 1
        },
        "user-mongodb": {
          "addr": "user-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "home-timeline-service": {
          "addr": "home-timeline-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "ssl": {
          "enabled": false,
          "caPath": "/keys/CA.pem",
          "ciphers": "ALL:!ADH:!LOW:!EXP:!MD5:@STRENGTH",
          "serverKeyPath": "/keys/server.key",
          "serverCertPath": "/keys/server.crt"
        },
        "redis-primary": {
          "keepalive_ms": 10000,
          "addr": "redis-master",
          "timeout_ms": 10000,
          "port": 6379,
          "connections": 512
        },
        "redis-replica": {
          "keepalive_ms": 10000,
          "addr": "redis-replicas",
          "timeout_ms": 10000,
          "port": 6379,
          "connections": 512
        }
      }
  jaeger-config.yml: |    
    disabled: false
    reporter:
      logSpans: true
      localAgentHostPort: "jaeger-agent:6831"
      queueSize: 100
      bufferFlushInterval: 10
    sampler:
      type: "const"
      param: 1
---
# Source: social-network/charts/text-service/templates/configmap.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: text-service
  labels:
    socialnetwork/service: text-service
data:
  service-config.json: |    
    {
        "secret": "secret",
        "social-graph-service": {
          "addr": "social-graph-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "social-graph-mongodb": {
          "addr": "social-graph-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "social-graph-redis": {
          "addr": "social-graph-redis",
          "port": 6379,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "use_cluster": 0,
          "use_replica": 0
        },
        "write-home-timeline-service": {
          "addr": "write-home-timeline-service",
          "port": 9090,
          "workers": 32,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "write-home-timeline-rabbitmq": {
          "addr": "write-home-timeline-rabbitmq",
          "port": 5672,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "home-timeline-redis": {
          "addr": "home-timeline-redis",
          "port": 6379,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "use_cluster": 0,
          "use_replica": 0
        },
        "compose-post-service": {
          "addr": "compose-post-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "compose-post-redis": {
          "addr": "compose-post-redis",
          "port": 6379,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "use_cluster": 0,
          "use_replica": 0
        },
        "user-timeline-service": {
          "addr": "user-timeline-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "user-timeline-mongodb": {
          "addr": "user-timeline-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "user-timeline-redis": {
          "addr": "user-timeline-redis",
          "port": 6379,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "use_cluster": 0,
          "use_replica": 0
        },
        "post-storage-service": {
          "addr": "post-storage-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "post-storage-mongodb": {
          "addr": "post-storage-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "post-storage-memcached": {
          "addr": "post-storage-memcached",
          "port": 11211,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "binary_protocol": 1
        },
        "unique-id-service": {
          "addr": "unique-id-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "netif": "eth0"
        },
        "media-service": {
          "addr": "media-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "media-mongodb": {
          "addr": "media-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "media-memcached": {
          "addr": "media-memcached",
          "port": 11211,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "binary_protocol": 1
        },
        "media-frontend": {
          "addr": "media-frontend",
          "port": 8081,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "text-service": {
          "addr": "text-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "user-mention-service": {
          "addr": "user-mention-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "url-shorten-service": {
          "addr": "url-shorten-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "url-shorten-memcached": {
          "addr": "url-shorten-memcached",
          "port": 11211,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "binary_protocol": 1
        },
        "url-shorten-mongodb": {
          "addr": "url-shorten-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "user-service": {
          "addr": "user-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "netif": "eth0"
        },
        "user-memcached": {
          "addr": "user-memcached",
          "port": 11211,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "binary_protocol": 1
        },
        "user-mongodb": {
          "addr": "user-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "home-timeline-service": {
          "addr": "home-timeline-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "ssl": {
          "enabled": false,
          "caPath": "/keys/CA.pem",
          "ciphers": "ALL:!ADH:!LOW:!EXP:!MD5:@STRENGTH",
          "serverKeyPath": "/keys/server.key",
          "serverCertPath": "/keys/server.crt"
        },
        "redis-primary": {
          "keepalive_ms": 10000,
          "addr": "redis-master",
          "timeout_ms": 10000,
          "port": 6379,
          "connections": 512
        },
        "redis-replica": {
          "keepalive_ms": 10000,
          "addr": "redis-replicas",
          "timeout_ms": 10000,
          "port": 6379,
          "connections": 512
        }
      }
  jaeger-config.yml: |    
    disabled: false
    reporter:
      logSpans: true
      localAgentHostPort: "jaeger-agent:6831"
      queueSize: 100
      bufferFlushInterval: 10
    sampler:
      type: "const"
      param: 1
---
# Source: social-network/charts/unique-id-service/templates/configmap.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: unique-id-service
  labels:
    socialnetwork/service: unique-id-service
data:
  service-config.json: |    
    {
        "secret": "secret",
        "social-graph-service": {
          "addr": "social-graph-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "social-graph-mongodb": {
          "addr": "social-graph-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "social-graph-redis": {
          "addr": "social-graph-redis",
          "port": 6379,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "use_cluster": 0,
          "use_replica": 0
        },
        "write-home-timeline-service": {
          "addr": "write-home-timeline-service",
          "port": 9090,
          "workers": 32,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "write-home-timeline-rabbitmq": {
          "addr": "write-home-timeline-rabbitmq",
          "port": 5672,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "home-timeline-redis": {
          "addr": "home-timeline-redis",
          "port": 6379,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "use_cluster": 0,
          "use_replica": 0
        },
        "compose-post-service": {
          "addr": "compose-post-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "compose-post-redis": {
          "addr": "compose-post-redis",
          "port": 6379,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "use_cluster": 0,
          "use_replica": 0
        },
        "user-timeline-service": {
          "addr": "user-timeline-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "user-timeline-mongodb": {
          "addr": "user-timeline-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "user-timeline-redis": {
          "addr": "user-timeline-redis",
          "port": 6379,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "use_cluster": 0,
          "use_replica": 0
        },
        "post-storage-service": {
          "addr": "post-storage-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "post-storage-mongodb": {
          "addr": "post-storage-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "post-storage-memcached": {
          "addr": "post-storage-memcached",
          "port": 11211,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "binary_protocol": 1
        },
        "unique-id-service": {
          "addr": "unique-id-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "netif": "eth0"
        },
        "media-service": {
          "addr": "media-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "media-mongodb": {
          "addr": "media-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "media-memcached": {
          "addr": "media-memcached",
          "port": 11211,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "binary_protocol": 1
        },
        "media-frontend": {
          "addr": "media-frontend",
          "port": 8081,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "text-service": {
          "addr": "text-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "user-mention-service": {
          "addr": "user-mention-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "url-shorten-service": {
          "addr": "url-shorten-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "url-shorten-memcached": {
          "addr": "url-shorten-memcached",
          "port": 11211,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "binary_protocol": 1
        },
        "url-shorten-mongodb": {
          "addr": "url-shorten-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "user-service": {
          "addr": "user-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "netif": "eth0"
        },
        "user-memcached": {
          "addr": "user-memcached",
          "port": 11211,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "binary_protocol": 1
        },
        "user-mongodb": {
          "addr": "user-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "home-timeline-service": {
          "addr": "home-timeline-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "ssl": {
          "enabled": false,
          "caPath": "/keys/CA.pem",
          "ciphers": "ALL:!ADH:!LOW:!EXP:!MD5:@STRENGTH",
          "serverKeyPath": "/keys/server.key",
          "serverCertPath": "/keys/server.crt"
        },
        "redis-primary": {
          "keepalive_ms": 10000,
          "addr": "redis-master",
          "timeout_ms": 10000,
          "port": 6379,
          "connections": 512
        },
        "redis-replica": {
          "keepalive_ms": 10000,
          "addr": "redis-replicas",
          "timeout_ms": 10000,
          "port": 6379,
          "connections": 512
        }
      }
  jaeger-config.yml: |    
    disabled: false
    reporter:
      logSpans: true
      localAgentHostPort: "jaeger-agent:6831"
      queueSize: 100
      bufferFlushInterval: 10
    sampler:
      type: "const"
      param: 1
---
# Source: social-network/charts/url-shorten-memcached/templates/configmap.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: url-shorten-memcached
  labels:
    socialnetwork/service: url-shorten-memcached
data:
  service-config.json: |    
    {
        "secret": "secret",
        "social-graph-service": {
          "addr": "social-graph-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "social-graph-mongodb": {
          "addr": "social-graph-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "social-graph-redis": {
          "addr": "social-graph-redis",
          "port": 6379,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "use_cluster": 0,
          "use_replica": 0
        },
        "write-home-timeline-service": {
          "addr": "write-home-timeline-service",
          "port": 9090,
          "workers": 32,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "write-home-timeline-rabbitmq": {
          "addr": "write-home-timeline-rabbitmq",
          "port": 5672,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "home-timeline-redis": {
          "addr": "home-timeline-redis",
          "port": 6379,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "use_cluster": 0,
          "use_replica": 0
        },
        "compose-post-service": {
          "addr": "compose-post-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "compose-post-redis": {
          "addr": "compose-post-redis",
          "port": 6379,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "use_cluster": 0,
          "use_replica": 0
        },
        "user-timeline-service": {
          "addr": "user-timeline-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "user-timeline-mongodb": {
          "addr": "user-timeline-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "user-timeline-redis": {
          "addr": "user-timeline-redis",
          "port": 6379,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "use_cluster": 0,
          "use_replica": 0
        },
        "post-storage-service": {
          "addr": "post-storage-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "post-storage-mongodb": {
          "addr": "post-storage-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "post-storage-memcached": {
          "addr": "post-storage-memcached",
          "port": 11211,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "binary_protocol": 1
        },
        "unique-id-service": {
          "addr": "unique-id-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "netif": "eth0"
        },
        "media-service": {
          "addr": "media-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "media-mongodb": {
          "addr": "media-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "media-memcached": {
          "addr": "media-memcached",
          "port": 11211,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "binary_protocol": 1
        },
        "media-frontend": {
          "addr": "media-frontend",
          "port": 8081,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "text-service": {
          "addr": "text-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "user-mention-service": {
          "addr": "user-mention-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "url-shorten-service": {
          "addr": "url-shorten-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "url-shorten-memcached": {
          "addr": "url-shorten-memcached",
          "port": 11211,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "binary_protocol": 1
        },
        "url-shorten-mongodb": {
          "addr": "url-shorten-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "user-service": {
          "addr": "user-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "netif": "eth0"
        },
        "user-memcached": {
          "addr": "user-memcached",
          "port": 11211,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "binary_protocol": 1
        },
        "user-mongodb": {
          "addr": "user-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "home-timeline-service": {
          "addr": "home-timeline-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "ssl": {
          "enabled": false,
          "caPath": "/keys/CA.pem",
          "ciphers": "ALL:!ADH:!LOW:!EXP:!MD5:@STRENGTH",
          "serverKeyPath": "/keys/server.key",
          "serverCertPath": "/keys/server.crt"
        },
        "redis-primary": {
          "keepalive_ms": 10000,
          "addr": "redis-master",
          "timeout_ms": 10000,
          "port": 6379,
          "connections": 512
        },
        "redis-replica": {
          "keepalive_ms": 10000,
          "addr": "redis-replicas",
          "timeout_ms": 10000,
          "port": 6379,
          "connections": 512
        }
      }
  jaeger-config.yml: |    
    disabled: false
    reporter:
      logSpans: true
      localAgentHostPort: "jaeger-agent:6831"
      queueSize: 100
      bufferFlushInterval: 10
    sampler:
      type: "const"
      param: 1
---
# Source: social-network/charts/url-shorten-mongodb/templates/configmap.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: url-shorten-mongodb
  labels:
    socialnetwork/service: url-shorten-mongodb
data:
  mongod.conf: |    
    net:
      tls:
        mode: disabled
---
# Source: social-network/charts/url-shorten-service/templates/configmap.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: url-shorten-service
  labels:
    socialnetwork/service: url-shorten-service
data:
  service-config.json: |    
    {
        "secret": "secret",
        "social-graph-service": {
          "addr": "social-graph-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "social-graph-mongodb": {
          "addr": "social-graph-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "social-graph-redis": {
          "addr": "social-graph-redis",
          "port": 6379,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "use_cluster": 0,
          "use_replica": 0
        },
        "write-home-timeline-service": {
          "addr": "write-home-timeline-service",
          "port": 9090,
          "workers": 32,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "write-home-timeline-rabbitmq": {
          "addr": "write-home-timeline-rabbitmq",
          "port": 5672,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "home-timeline-redis": {
          "addr": "home-timeline-redis",
          "port": 6379,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "use_cluster": 0,
          "use_replica": 0
        },
        "compose-post-service": {
          "addr": "compose-post-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "compose-post-redis": {
          "addr": "compose-post-redis",
          "port": 6379,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "use_cluster": 0,
          "use_replica": 0
        },
        "user-timeline-service": {
          "addr": "user-timeline-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "user-timeline-mongodb": {
          "addr": "user-timeline-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "user-timeline-redis": {
          "addr": "user-timeline-redis",
          "port": 6379,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "use_cluster": 0,
          "use_replica": 0
        },
        "post-storage-service": {
          "addr": "post-storage-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "post-storage-mongodb": {
          "addr": "post-storage-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "post-storage-memcached": {
          "addr": "post-storage-memcached",
          "port": 11211,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "binary_protocol": 1
        },
        "unique-id-service": {
          "addr": "unique-id-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "netif": "eth0"
        },
        "media-service": {
          "addr": "media-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "media-mongodb": {
          "addr": "media-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "media-memcached": {
          "addr": "media-memcached",
          "port": 11211,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "binary_protocol": 1
        },
        "media-frontend": {
          "addr": "media-frontend",
          "port": 8081,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "text-service": {
          "addr": "text-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "user-mention-service": {
          "addr": "user-mention-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "url-shorten-service": {
          "addr": "url-shorten-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "url-shorten-memcached": {
          "addr": "url-shorten-memcached",
          "port": 11211,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "binary_protocol": 1
        },
        "url-shorten-mongodb": {
          "addr": "url-shorten-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "user-service": {
          "addr": "user-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "netif": "eth0"
        },
        "user-memcached": {
          "addr": "user-memcached",
          "port": 11211,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "binary_protocol": 1
        },
        "user-mongodb": {
          "addr": "user-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "home-timeline-service": {
          "addr": "home-timeline-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "ssl": {
          "enabled": false,
          "caPath": "/keys/CA.pem",
          "ciphers": "ALL:!ADH:!LOW:!EXP:!MD5:@STRENGTH",
          "serverKeyPath": "/keys/server.key",
          "serverCertPath": "/keys/server.crt"
        },
        "redis-primary": {
          "keepalive_ms": 10000,
          "addr": "redis-master",
          "timeout_ms": 10000,
          "port": 6379,
          "connections": 512
        },
        "redis-replica": {
          "keepalive_ms": 10000,
          "addr": "redis-replicas",
          "timeout_ms": 10000,
          "port": 6379,
          "connections": 512
        }
      }
  jaeger-config.yml: |    
    disabled: false
    reporter:
      logSpans: true
      localAgentHostPort: "jaeger-agent:6831"
      queueSize: 100
      bufferFlushInterval: 10
    sampler:
      type: "const"
      param: 1
---
# Source: social-network/charts/user-memcached/templates/configmap.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: user-memcached
  labels:
    socialnetwork/service: user-memcached
data:
  service-config.json: |    
    {
        "secret": "secret",
        "social-graph-service": {
          "addr": "social-graph-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "social-graph-mongodb": {
          "addr": "social-graph-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "social-graph-redis": {
          "addr": "social-graph-redis",
          "port": 6379,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "use_cluster": 0,
          "use_replica": 0
        },
        "write-home-timeline-service": {
          "addr": "write-home-timeline-service",
          "port": 9090,
          "workers": 32,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "write-home-timeline-rabbitmq": {
          "addr": "write-home-timeline-rabbitmq",
          "port": 5672,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "home-timeline-redis": {
          "addr": "home-timeline-redis",
          "port": 6379,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "use_cluster": 0,
          "use_replica": 0
        },
        "compose-post-service": {
          "addr": "compose-post-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "compose-post-redis": {
          "addr": "compose-post-redis",
          "port": 6379,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "use_cluster": 0,
          "use_replica": 0
        },
        "user-timeline-service": {
          "addr": "user-timeline-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "user-timeline-mongodb": {
          "addr": "user-timeline-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "user-timeline-redis": {
          "addr": "user-timeline-redis",
          "port": 6379,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "use_cluster": 0,
          "use_replica": 0
        },
        "post-storage-service": {
          "addr": "post-storage-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "post-storage-mongodb": {
          "addr": "post-storage-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "post-storage-memcached": {
          "addr": "post-storage-memcached",
          "port": 11211,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "binary_protocol": 1
        },
        "unique-id-service": {
          "addr": "unique-id-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "netif": "eth0"
        },
        "media-service": {
          "addr": "media-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "media-mongodb": {
          "addr": "media-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "media-memcached": {
          "addr": "media-memcached",
          "port": 11211,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "binary_protocol": 1
        },
        "media-frontend": {
          "addr": "media-frontend",
          "port": 8081,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "text-service": {
          "addr": "text-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "user-mention-service": {
          "addr": "user-mention-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "url-shorten-service": {
          "addr": "url-shorten-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "url-shorten-memcached": {
          "addr": "url-shorten-memcached",
          "port": 11211,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "binary_protocol": 1
        },
        "url-shorten-mongodb": {
          "addr": "url-shorten-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "user-service": {
          "addr": "user-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "netif": "eth0"
        },
        "user-memcached": {
          "addr": "user-memcached",
          "port": 11211,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "binary_protocol": 1
        },
        "user-mongodb": {
          "addr": "user-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "home-timeline-service": {
          "addr": "home-timeline-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "ssl": {
          "enabled": false,
          "caPath": "/keys/CA.pem",
          "ciphers": "ALL:!ADH:!LOW:!EXP:!MD5:@STRENGTH",
          "serverKeyPath": "/keys/server.key",
          "serverCertPath": "/keys/server.crt"
        },
        "redis-primary": {
          "keepalive_ms": 10000,
          "addr": "redis-master",
          "timeout_ms": 10000,
          "port": 6379,
          "connections": 512
        },
        "redis-replica": {
          "keepalive_ms": 10000,
          "addr": "redis-replicas",
          "timeout_ms": 10000,
          "port": 6379,
          "connections": 512
        }
      }
  jaeger-config.yml: |    
    disabled: false
    reporter:
      logSpans: true
      localAgentHostPort: "jaeger-agent:6831"
      queueSize: 100
      bufferFlushInterval: 10
    sampler:
      type: "const"
      param: 1
---
# Source: social-network/charts/user-mention-service/templates/configmap.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: user-mention-service
  labels:
    socialnetwork/service: user-mention-service
data:
  service-config.json: |    
    {
        "secret": "secret",
        "social-graph-service": {
          "addr": "social-graph-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "social-graph-mongodb": {
          "addr": "social-graph-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "social-graph-redis": {
          "addr": "social-graph-redis",
          "port": 6379,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "use_cluster": 0,
          "use_replica": 0
        },
        "write-home-timeline-service": {
          "addr": "write-home-timeline-service",
          "port": 9090,
          "workers": 32,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "write-home-timeline-rabbitmq": {
          "addr": "write-home-timeline-rabbitmq",
          "port": 5672,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "home-timeline-redis": {
          "addr": "home-timeline-redis",
          "port": 6379,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "use_cluster": 0,
          "use_replica": 0
        },
        "compose-post-service": {
          "addr": "compose-post-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "compose-post-redis": {
          "addr": "compose-post-redis",
          "port": 6379,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "use_cluster": 0,
          "use_replica": 0
        },
        "user-timeline-service": {
          "addr": "user-timeline-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "user-timeline-mongodb": {
          "addr": "user-timeline-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "user-timeline-redis": {
          "addr": "user-timeline-redis",
          "port": 6379,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "use_cluster": 0,
          "use_replica": 0
        },
        "post-storage-service": {
          "addr": "post-storage-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "post-storage-mongodb": {
          "addr": "post-storage-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "post-storage-memcached": {
          "addr": "post-storage-memcached",
          "port": 11211,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "binary_protocol": 1
        },
        "unique-id-service": {
          "addr": "unique-id-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "netif": "eth0"
        },
        "media-service": {
          "addr": "media-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "media-mongodb": {
          "addr": "media-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "media-memcached": {
          "addr": "media-memcached",
          "port": 11211,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "binary_protocol": 1
        },
        "media-frontend": {
          "addr": "media-frontend",
          "port": 8081,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "text-service": {
          "addr": "text-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "user-mention-service": {
          "addr": "user-mention-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "url-shorten-service": {
          "addr": "url-shorten-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "url-shorten-memcached": {
          "addr": "url-shorten-memcached",
          "port": 11211,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "binary_protocol": 1
        },
        "url-shorten-mongodb": {
          "addr": "url-shorten-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "user-service": {
          "addr": "user-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "netif": "eth0"
        },
        "user-memcached": {
          "addr": "user-memcached",
          "port": 11211,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "binary_protocol": 1
        },
        "user-mongodb": {
          "addr": "user-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "home-timeline-service": {
          "addr": "home-timeline-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "ssl": {
          "enabled": false,
          "caPath": "/keys/CA.pem",
          "ciphers": "ALL:!ADH:!LOW:!EXP:!MD5:@STRENGTH",
          "serverKeyPath": "/keys/server.key",
          "serverCertPath": "/keys/server.crt"
        },
        "redis-primary": {
          "keepalive_ms": 10000,
          "addr": "redis-master",
          "timeout_ms": 10000,
          "port": 6379,
          "connections": 512
        },
        "redis-replica": {
          "keepalive_ms": 10000,
          "addr": "redis-replicas",
          "timeout_ms": 10000,
          "port": 6379,
          "connections": 512
        }
      }
  jaeger-config.yml: |    
    disabled: false
    reporter:
      logSpans: true
      localAgentHostPort: "jaeger-agent:6831"
      queueSize: 100
      bufferFlushInterval: 10
    sampler:
      type: "const"
      param: 1
---
# Source: social-network/charts/user-mongodb/templates/configmap.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: user-mongodb
  labels:
    socialnetwork/service: user-mongodb
data:
  mongod.conf: |    
    net:
      tls:
        mode: disabled
---
# Source: social-network/charts/user-service/templates/configmap.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: user-service
  labels:
    socialnetwork/service: user-service
data:
  service-config.json: |    
    {
        "secret": "secret",
        "social-graph-service": {
          "addr": "social-graph-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "social-graph-mongodb": {
          "addr": "social-graph-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "social-graph-redis": {
          "addr": "social-graph-redis",
          "port": 6379,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "use_cluster": 0,
          "use_replica": 0
        },
        "write-home-timeline-service": {
          "addr": "write-home-timeline-service",
          "port": 9090,
          "workers": 32,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "write-home-timeline-rabbitmq": {
          "addr": "write-home-timeline-rabbitmq",
          "port": 5672,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "home-timeline-redis": {
          "addr": "home-timeline-redis",
          "port": 6379,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "use_cluster": 0,
          "use_replica": 0
        },
        "compose-post-service": {
          "addr": "compose-post-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "compose-post-redis": {
          "addr": "compose-post-redis",
          "port": 6379,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "use_cluster": 0,
          "use_replica": 0
        },
        "user-timeline-service": {
          "addr": "user-timeline-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "user-timeline-mongodb": {
          "addr": "user-timeline-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "user-timeline-redis": {
          "addr": "user-timeline-redis",
          "port": 6379,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "use_cluster": 0,
          "use_replica": 0
        },
        "post-storage-service": {
          "addr": "post-storage-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "post-storage-mongodb": {
          "addr": "post-storage-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "post-storage-memcached": {
          "addr": "post-storage-memcached",
          "port": 11211,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "binary_protocol": 1
        },
        "unique-id-service": {
          "addr": "unique-id-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "netif": "eth0"
        },
        "media-service": {
          "addr": "media-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "media-mongodb": {
          "addr": "media-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "media-memcached": {
          "addr": "media-memcached",
          "port": 11211,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "binary_protocol": 1
        },
        "media-frontend": {
          "addr": "media-frontend",
          "port": 8081,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "text-service": {
          "addr": "text-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "user-mention-service": {
          "addr": "user-mention-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "url-shorten-service": {
          "addr": "url-shorten-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "url-shorten-memcached": {
          "addr": "url-shorten-memcached",
          "port": 11211,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "binary_protocol": 1
        },
        "url-shorten-mongodb": {
          "addr": "url-shorten-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "user-service": {
          "addr": "user-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "netif": "eth0"
        },
        "user-memcached": {
          "addr": "user-memcached",
          "port": 11211,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "binary_protocol": 1
        },
        "user-mongodb": {
          "addr": "user-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "home-timeline-service": {
          "addr": "home-timeline-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "ssl": {
          "enabled": false,
          "caPath": "/keys/CA.pem",
          "ciphers": "ALL:!ADH:!LOW:!EXP:!MD5:@STRENGTH",
          "serverKeyPath": "/keys/server.key",
          "serverCertPath": "/keys/server.crt"
        },
        "redis-primary": {
          "keepalive_ms": 10000,
          "addr": "redis-master",
          "timeout_ms": 10000,
          "port": 6379,
          "connections": 512
        },
        "redis-replica": {
          "keepalive_ms": 10000,
          "addr": "redis-replicas",
          "timeout_ms": 10000,
          "port": 6379,
          "connections": 512
        }
      }
  jaeger-config.yml: |    
    disabled: false
    reporter:
      logSpans: true
      localAgentHostPort: "jaeger-agent:6831"
      queueSize: 100
      bufferFlushInterval: 10
    sampler:
      type: "const"
      param: 1
---
# Source: social-network/charts/user-timeline-mongodb/templates/configmap.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: user-timeline-mongodb
  labels:
    socialnetwork/service: user-timeline-mongodb
data:
  mongod.conf: |    
    net:
      tls:
        mode: disabled
---
# Source: social-network/charts/user-timeline-redis/templates/configmap.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: user-timeline-redis
  labels:
    socialnetwork/service: user-timeline-redis
data:
  redis.conf: |    
    io-threads 8
    io-threads-do-reads yes
    port 6379
    tls-port 0
    
    tls-cert-file /keys/server.crt
    tls-key-file /keys/server.key
    
    tls-auth-clients no
---
# Source: social-network/charts/user-timeline-service/templates/configmap.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: user-timeline-service
  labels:
    socialnetwork/service: user-timeline-service
data:
  service-config.json: |    
    {
        "secret": "secret",
        "social-graph-service": {
          "addr": "social-graph-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "social-graph-mongodb": {
          "addr": "social-graph-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "social-graph-redis": {
          "addr": "social-graph-redis",
          "port": 6379,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "use_cluster": 0,
          "use_replica": 0
        },
        "write-home-timeline-service": {
          "addr": "write-home-timeline-service",
          "port": 9090,
          "workers": 32,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "write-home-timeline-rabbitmq": {
          "addr": "write-home-timeline-rabbitmq",
          "port": 5672,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "home-timeline-redis": {
          "addr": "home-timeline-redis",
          "port": 6379,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "use_cluster": 0,
          "use_replica": 0
        },
        "compose-post-service": {
          "addr": "compose-post-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "compose-post-redis": {
          "addr": "compose-post-redis",
          "port": 6379,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "use_cluster": 0,
          "use_replica": 0
        },
        "user-timeline-service": {
          "addr": "user-timeline-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "user-timeline-mongodb": {
          "addr": "user-timeline-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "user-timeline-redis": {
          "addr": "user-timeline-redis",
          "port": 6379,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "use_cluster": 0,
          "use_replica": 0
        },
        "post-storage-service": {
          "addr": "post-storage-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "post-storage-mongodb": {
          "addr": "post-storage-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "post-storage-memcached": {
          "addr": "post-storage-memcached",
          "port": 11211,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "binary_protocol": 1
        },
        "unique-id-service": {
          "addr": "unique-id-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "netif": "eth0"
        },
        "media-service": {
          "addr": "media-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "media-mongodb": {
          "addr": "media-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "media-memcached": {
          "addr": "media-memcached",
          "port": 11211,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "binary_protocol": 1
        },
        "media-frontend": {
          "addr": "media-frontend",
          "port": 8081,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "text-service": {
          "addr": "text-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "user-mention-service": {
          "addr": "user-mention-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "url-shorten-service": {
          "addr": "url-shorten-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "url-shorten-memcached": {
          "addr": "url-shorten-memcached",
          "port": 11211,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "binary_protocol": 1
        },
        "url-shorten-mongodb": {
          "addr": "url-shorten-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "user-service": {
          "addr": "user-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "netif": "eth0"
        },
        "user-memcached": {
          "addr": "user-memcached",
          "port": 11211,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000,
          "binary_protocol": 1
        },
        "user-mongodb": {
          "addr": "user-mongodb",
          "port": 27017,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "home-timeline-service": {
          "addr": "home-timeline-service",
          "port": 9090,
          "connections": 512,
          "timeout_ms": 10000,
          "keepalive_ms": 10000
        },
        "ssl": {
          "enabled": false,
          "caPath": "/keys/CA.pem",
          "ciphers": "ALL:!ADH:!LOW:!EXP:!MD5:@STRENGTH",
          "serverKeyPath": "/keys/server.key",
          "serverCertPath": "/keys/server.crt"
        },
        "redis-primary": {
          "keepalive_ms": 10000,
          "addr": "redis-master",
          "timeout_ms": 10000,
          "port": 6379,
          "connections": 512
        },
        "redis-replica": {
          "keepalive_ms": 10000,
          "addr": "redis-replicas",
          "timeout_ms": 10000,
          "port": 6379,
          "connections": 512
        }
      }
  jaeger-config.yml: |    
    disabled: false
    reporter:
      logSpans: true
      localAgentHostPort: "jaeger-agent:6831"
      queueSize: 100
      bufferFlushInterval: 10
    sampler:
      type: "const"
      param: 1
---
# Source: social-network/charts/compose-post-service/templates/service.yaml
apiVersion: v1
kind: Service
metadata:
  name: compose-post-service
spec:
  type: ClusterIP
  ports:
  - name: "9090"
    port: 9090
    targetPort: 9090
  selector:
    service: compose-post-service
---
# Source: social-network/charts/home-timeline-redis/templates/service.yaml
apiVersion: v1
kind: Service
metadata:
  name: home-timeline-redis
spec:
  type: ClusterIP
  ports:
  - name: "6379"
    port: 6379
    targetPort: 6379
  selector:
    service: home-timeline-redis
---
# Source: social-network/charts/home-timeline-service/templates/service.yaml
apiVersion: v1
kind: Service
metadata:
  name: home-timeline-service
spec:
  type: ClusterIP
  ports:
  - name: "9090"
    port: 9090
    targetPort: 9090
  selector:
    service: home-timeline-service
---
# Source: social-network/charts/jaeger/charts/elasticsearch/templates/coordinating/svc-headless.yaml
apiVersion: v1
kind: Service
metadata:
  name: socialnetwork-elasticsearch-coordinating-hl
  namespace: "default"
  labels:
    app.kubernetes.io/instance: socialnetwork
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: elasticsearch
    app.kubernetes.io/version: 8.13.2
    helm.sh/chart: elasticsearch-20.0.4
    app.kubernetes.io/component: coordinating-only
spec:
  type: ClusterIP
  clusterIP: None
  publishNotReadyAddresses: true
  ports:
    - name: tcp-rest-api
      port: 9200
      targetPort: rest-api
    - name: tcp-transport
      port: 9300
      targetPort: transport
  selector:
    app.kubernetes.io/instance: socialnetwork
    app.kubernetes.io/name: elasticsearch
    app.kubernetes.io/component: coordinating-only
---
# Source: social-network/charts/jaeger/charts/elasticsearch/templates/data/svc-headless.yaml
apiVersion: v1
kind: Service
metadata:
  name: socialnetwork-elasticsearch-data-hl
  namespace: "default"
  labels:
    app.kubernetes.io/instance: socialnetwork
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: elasticsearch
    app.kubernetes.io/version: 8.13.2
    helm.sh/chart: elasticsearch-20.0.4
    app.kubernetes.io/component: data
spec:
  type: ClusterIP
  clusterIP: None
  publishNotReadyAddresses: true
  ports:
    - name: tcp-rest-api
      port: 9200
      targetPort: rest-api
    - name: tcp-transport
      port: 9300
      targetPort: transport
  selector:
    app.kubernetes.io/instance: socialnetwork
    app.kubernetes.io/name: elasticsearch
    app.kubernetes.io/component: data
---
# Source: social-network/charts/jaeger/charts/elasticsearch/templates/ingest/svc-headless.yaml
apiVersion: v1
kind: Service
metadata:
  name: socialnetwork-elasticsearch-ingest-hl
  namespace: "default"
  labels:
    app.kubernetes.io/instance: socialnetwork
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: elasticsearch
    app.kubernetes.io/version: 8.13.2
    helm.sh/chart: elasticsearch-20.0.4
    app.kubernetes.io/component: ingest
spec:
  type: ClusterIP
  clusterIP: None
  publishNotReadyAddresses: true
  ports:
    - name: tcp-rest-api
      port: 9200
      targetPort: rest-api
    - name: tcp-transport
      port: 9300
      targetPort: transport
  selector:
    app.kubernetes.io/instance: socialnetwork
    app.kubernetes.io/name: elasticsearch
    app.kubernetes.io/component: ingest
---
# Source: social-network/charts/jaeger/charts/elasticsearch/templates/master/svc-headless.yaml
apiVersion: v1
kind: Service
metadata:
  name: socialnetwork-elasticsearch-master-hl
  namespace: "default"
  labels:
    app.kubernetes.io/instance: socialnetwork
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: elasticsearch
    app.kubernetes.io/version: 8.13.2
    helm.sh/chart: elasticsearch-20.0.4
    app.kubernetes.io/component: master
spec:
  type: ClusterIP
  clusterIP: None
  publishNotReadyAddresses: true
  ports:
    - name: tcp-rest-api
      port: 9200
      targetPort: rest-api
    - name: tcp-transport
      port: 9300
      targetPort: transport
  selector:
    app.kubernetes.io/instance: socialnetwork
    app.kubernetes.io/name: elasticsearch
    app.kubernetes.io/component: master
---
# Source: social-network/charts/jaeger/charts/elasticsearch/templates/service.yaml
apiVersion: v1
kind: Service
metadata:
  name: socialnetwork-elasticsearch
  namespace: "default"
  labels:
    app.kubernetes.io/instance: socialnetwork
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: elasticsearch
    app.kubernetes.io/version: 8.13.2
    helm.sh/chart: elasticsearch-20.0.4
    app.kubernetes.io/component: coordinating-only
spec:
  type: ClusterIP
  sessionAffinity: None
  ports:
    - name: tcp-rest-api
      port: 9200
      targetPort: rest-api
      nodePort: null
    - name: tcp-transport
      port: 9300
      nodePort: null
  selector:
    app.kubernetes.io/instance: socialnetwork
    app.kubernetes.io/name: elasticsearch
    app.kubernetes.io/component: coordinating-only
---
# Source: social-network/charts/jaeger/templates/agent-svc.yaml
apiVersion: v1
kind: Service
metadata:
  name: jaeger-agent
  labels:
    helm.sh/chart: jaeger-3.3.0
    app.kubernetes.io/name: jaeger
    app.kubernetes.io/instance: socialnetwork
    app.kubernetes.io/version: "1.53.0"
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/component: agent
spec:
  ports:
  - name: zipkin-compact
    port: 5775
    protocol: UDP
    targetPort: zipkin-compact
  - name: jaeger-compact
    port: 6831
    protocol: UDP
    targetPort: jaeger-compact
  - name: jaeger-binary
    port: 6832
    protocol: UDP
    targetPort: jaeger-binary
  - name: http
    port: 5778
    protocol: TCP
    targetPort: http
  - name: admin
    port: 14271
    protocol: TCP
    targetPort: admin
  type: ClusterIP
  selector:
    app.kubernetes.io/name: jaeger
    app.kubernetes.io/instance: socialnetwork
    app.kubernetes.io/component: agent
---
# Source: social-network/charts/jaeger/templates/collector-svc.yaml
apiVersion: v1
kind: Service
metadata:
  name: jaeger-collector
  labels:
    helm.sh/chart: jaeger-3.3.0
    app.kubernetes.io/name: jaeger
    app.kubernetes.io/instance: socialnetwork
    app.kubernetes.io/version: "1.53.0"
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/component: collector
spec:
  ports:
  - name: grpc
    port: 14250
    protocol: TCP
    targetPort: grpc
    appProtocol: grpc
  - name: http
    port: 14268
    protocol: TCP
    targetPort: http
    appProtocol: http
  - name: admin
    port: 14269
    targetPort: admin
  selector:
    app.kubernetes.io/name: jaeger
    app.kubernetes.io/instance: socialnetwork
    app.kubernetes.io/component: collector
  type: ClusterIP
---
# Source: social-network/charts/jaeger/templates/query-svc.yaml
apiVersion: v1
kind: Service
metadata:
  name: jaeger-query
  labels:
    helm.sh/chart: jaeger-3.3.0
    app.kubernetes.io/name: jaeger
    app.kubernetes.io/instance: socialnetwork
    app.kubernetes.io/version: "1.53.0"
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/component: query
spec:
  ports:
  - name: query
    port: 80
    protocol: TCP
    targetPort: query
  - name: grpc
    port: 16685
    protocol: TCP
    targetPort: grpc
  - name: admin
    port: 16687
    protocol: TCP
    targetPort: admin
  selector:
    app.kubernetes.io/name: jaeger
    app.kubernetes.io/instance: socialnetwork
    app.kubernetes.io/component: query
  type: ClusterIP
---
# Source: social-network/charts/media-frontend/templates/service.yaml
apiVersion: v1
kind: Service
metadata:
  name: media-frontend
spec:
  type: ClusterIP
  ports:
  - name: "8081"
    port: 8081
    targetPort: 8080
  selector:
    service: media-frontend
---
# Source: social-network/charts/media-memcached/templates/service.yaml
apiVersion: v1
kind: Service
metadata:
  name: media-memcached
spec:
  type: ClusterIP
  ports:
  - name: "11211"
    port: 11211
    targetPort: 11211
  selector:
    service: media-memcached
---
# Source: social-network/charts/media-mongodb/templates/service.yaml
apiVersion: v1
kind: Service
metadata:
  name: media-mongodb
spec:
  type: ClusterIP
  ports:
  - name: "27017"
    port: 27017
    targetPort: 27017
  selector:
    service: media-mongodb
---
# Source: social-network/charts/media-service/templates/service.yaml
apiVersion: v1
kind: Service
metadata:
  name: media-service
spec:
  type: ClusterIP
  ports:
  - name: "9090"
    port: 9090
    targetPort: 9090
  selector:
    service: media-service
---
# Source: social-network/charts/nginx-thrift/templates/service.yaml
apiVersion: v1
kind: Service
metadata:
  name: nginx-thrift
spec:
  type: LoadBalancer
  ports:
  - name: "8080"
    port: 8080
    targetPort: 8080
  selector:
    service: nginx-thrift
---
# Source: social-network/charts/post-storage-memcached/templates/service.yaml
apiVersion: v1
kind: Service
metadata:
  name: post-storage-memcached
spec:
  type: ClusterIP
  ports:
  - name: "11211"
    port: 11211
    targetPort: 11211
  selector:
    service: post-storage-memcached
---
# Source: social-network/charts/post-storage-mongodb/templates/service.yaml
apiVersion: v1
kind: Service
metadata:
  name: post-storage-mongodb
spec:
  type: ClusterIP
  ports:
  - name: "27017"
    port: 27017
    targetPort: 27017
  selector:
    service: post-storage-mongodb
---
# Source: social-network/charts/post-storage-service/templates/service.yaml
apiVersion: v1
kind: Service
metadata:
  name: post-storage-service
spec:
  type: ClusterIP
  ports:
  - name: "9090"
    port: 9090
    targetPort: 9090
  selector:
    service: post-storage-service
---
# Source: social-network/charts/social-graph-mongodb/templates/service.yaml
apiVersion: v1
kind: Service
metadata:
  name: social-graph-mongodb
spec:
  type: ClusterIP
  ports:
  - name: "27017"
    port: 27017
    targetPort: 27017
  selector:
    service: social-graph-mongodb
---
# Source: social-network/charts/social-graph-redis/templates/service.yaml
apiVersion: v1
kind: Service
metadata:
  name: social-graph-redis
spec:
  type: ClusterIP
  ports:
  - name: "6379"
    port: 6379
    targetPort: 6379
  selector:
    service: social-graph-redis
---
# Source: social-network/charts/social-graph-service/templates/service.yaml
apiVersion: v1
kind: Service
metadata:
  name: social-graph-service
spec:
  type: ClusterIP
  ports:
  - name: "9090"
    port: 9090
    targetPort: 9090
  selector:
    service: social-graph-service
---
# Source: social-network/charts/text-service/templates/service.yaml
apiVersion: v1
kind: Service
metadata:
  name: text-service
spec:
  type: ClusterIP
  ports:
  - name: "9090"
    port: 9090
    targetPort: 9090
  selector:
    service: text-service
---
# Source: social-network/charts/unique-id-service/templates/service.yaml
apiVersion: v1
kind: Service
metadata:
  name: unique-id-service
spec:
  type: ClusterIP
  ports:
  - name: "9090"
    port: 9090
    targetPort: 9090
  selector:
    service: unique-id-service
---
# Source: social-network/charts/url-shorten-memcached/templates/service.yaml
apiVersion: v1
kind: Service
metadata:
  name: url-shorten-memcached
spec:
  type: ClusterIP
  ports:
  - name: "11211"
    port: 11211
    targetPort: 11211
  selector:
    service: url-shorten-memcached
---
# Source: social-network/charts/url-shorten-mongodb/templates/service.yaml
apiVersion: v1
kind: Service
metadata:
  name: url-shorten-mongodb
spec:
  type: ClusterIP
  ports:
  - name: "27017"
    port: 27017
    targetPort: 27017
  selector:
    service: url-shorten-mongodb
---
# Source: social-network/charts/url-shorten-service/templates/service.yaml
apiVersion: v1
kind: Service
metadata:
  name: url-shorten-service
spec:
  type: ClusterIP
  ports:
  - name: "9090"
    port: 9090
    targetPort: 9090
  selector:
    service: url-shorten-service
---
# Source: social-network/charts/user-memcached/templates/service.yaml
apiVersion: v1
kind: Service
metadata:
  name: user-memcached
spec:
  type: ClusterIP
  ports:
  - name: "11211"
    port: 11211
    targetPort: 11211
  selector:
    service: user-memcached
---
# Source: social-network/charts/user-mention-service/templates/service.yaml
apiVersion: v1
kind: Service
metadata:
  name: user-mention-service
spec:
  type: ClusterIP
  ports:
  - name: "9090"
    port: 9090
    targetPort: 9090
  selector:
    service: user-mention-service
---
# Source: social-network/charts/user-mongodb/templates/service.yaml
apiVersion: v1
kind: Service
metadata:
  name: user-mongodb
spec:
  type: ClusterIP
  ports:
  - name: "27017"
    port: 27017
    targetPort: 27017
  selector:
    service: user-mongodb
---
# Source: social-network/charts/user-service/templates/service.yaml
apiVersion: v1
kind: Service
metadata:
  name: user-service
spec:
  type: ClusterIP
  ports:
  - name: "9090"
    port: 9090
    targetPort: 9090
  selector:
    service: user-service
---
# Source: social-network/charts/user-timeline-mongodb/templates/service.yaml
apiVersion: v1
kind: Service
metadata:
  name: user-timeline-mongodb
spec:
  type: ClusterIP
  ports:
  - name: "27017"
    port: 27017
    targetPort: 27017
  selector:
    service: user-timeline-mongodb
---
# Source: social-network/charts/user-timeline-redis/templates/service.yaml
apiVersion: v1
kind: Service
metadata:
  name: user-timeline-redis
spec:
  type: ClusterIP
  ports:
  - name: "6379"
    port: 6379
    targetPort: 6379
  selector:
    service: user-timeline-redis
---
# Source: social-network/charts/user-timeline-service/templates/service.yaml
apiVersion: v1
kind: Service
metadata:
  name: user-timeline-service
spec:
  type: ClusterIP
  ports:
  - name: "9090"
    port: 9090
    targetPort: 9090
  selector:
    service: user-timeline-service
---
# Source: social-network/charts/jaeger/templates/agent-ds.yaml
apiVersion: apps/v1
kind: DaemonSet
metadata:
  name: jaeger-agent
  labels:
    helm.sh/chart: jaeger-3.3.0
    app.kubernetes.io/name: jaeger
    app.kubernetes.io/instance: socialnetwork
    app.kubernetes.io/version: "1.53.0"
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/component: agent
spec:
  selector:
    matchLabels:
      app.kubernetes.io/name: jaeger
      app.kubernetes.io/instance: socialnetwork
      app.kubernetes.io/component: agent
  template:
    metadata:
      labels:
        app.kubernetes.io/name: jaeger
        app.kubernetes.io/instance: socialnetwork
        app.kubernetes.io/component: agent
    spec:
      securityContext:
        {}
      dnsPolicy: ClusterFirst
      serviceAccountName: jaeger-agent
      
      containers:
      - name: jaeger-agent
        securityContext:
          {}
        image: jaegertracing/jaeger-agent:1.53.0
        imagePullPolicy: IfNotPresent
        args:
          
          
        env:
          - name: REPORTER_GRPC_HOST_PORT
            value: jaeger-collector:14250
        ports:
        - name: zipkin-compact
          containerPort: 5775
          protocol: UDP
        - name: jaeger-compact
          containerPort: 6831
          protocol: UDP
        - name: jaeger-binary
          containerPort: 6832
          protocol: UDP
        - name: http
          containerPort: 5778
          protocol: TCP
        - name: admin
          containerPort: 14271
          protocol: TCP
        livenessProbe:
          httpGet:
            path: /
            port: admin
        readinessProbe:
          httpGet:
            path: /
            port: admin
        resources:
          {}
        volumeMounts:
      volumes:
---
# Source: social-network/charts/compose-post-service/templates/deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    service: compose-post-service
  name: compose-post-service
spec: 
  replicas: 1
  selector:
    matchLabels:
      service: compose-post-service
  template:
    metadata:
      labels:
        service: compose-post-service
        app: compose-post-service
    spec:
      containers:
      - name: "compose-post-service"
        image: docker.io/lewisrye/social-network-microservices:latest
        imagePullPolicy: IfNotPresent
        ports:
        - containerPort: 9090
        command: 
        - ComposePostService
        resources:
          limits:
            cpu: 1000m        
        volumeMounts:
        - name: compose-post-service-config
          mountPath: /social-network-microservices/config/service-config.json
          subPath: service-config.json
        - name: compose-post-service-config
          mountPath: /social-network-microservices/config/jaeger-config.yml
          subPath: jaeger-config.yml
      volumes:
      - name: compose-post-service-config
        configMap:
          name: compose-post-service
      hostname: compose-post-service
      restartPolicy: Always
---
# Source: social-network/charts/home-timeline-redis/templates/deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    service: home-timeline-redis
  name: home-timeline-redis
spec: 
  replicas: 1
  selector:
    matchLabels:
      service: home-timeline-redis
  template:
    metadata:
      labels:
        service: home-timeline-redis
        app: home-timeline-redis
    spec:
      containers:
      - name: "home-timeline-redis"
        image: docker.io/library/redis:6.2.4
        imagePullPolicy: IfNotPresent
        ports:
        - containerPort: 6379
        args:
        - /social-network-microservices/config/redis.conf
        resources:
          limits:
            cpu: 1000m        
        volumeMounts:
        - name: home-timeline-redis-config
          mountPath: /social-network-microservices/config/redis.conf
          subPath: redis.conf
      volumes:
      - name: home-timeline-redis-config
        configMap:
          name: home-timeline-redis
      hostname: home-timeline-redis
      restartPolicy: Always
---
# Source: social-network/charts/home-timeline-service/templates/deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    service: home-timeline-service
  name: home-timeline-service
spec: 
  replicas: 1
  selector:
    matchLabels:
      service: home-timeline-service
  template:
    metadata:
      labels:
        service: home-timeline-service
        app: home-timeline-service
    spec:
      containers:
      - name: "home-timeline-service"
        image: docker.io/lewisrye/social-network-microservices:latest
        imagePullPolicy: IfNotPresent
        ports:
        - containerPort: 9090
        command: 
        - HomeTimelineService
        resources:
          limits:
            cpu: 1000m        
        volumeMounts:
        - name: home-timeline-service-config
          mountPath: /social-network-microservices/config/service-config.json
          subPath: service-config.json
        - name: home-timeline-service-config
          mountPath: /social-network-microservices/config/jaeger-config.yml
          subPath: jaeger-config.yml
      volumes:
      - name: home-timeline-service-config
        configMap:
          name: home-timeline-service
      hostname: home-timeline-service
      restartPolicy: Always
---
# Source: social-network/charts/jaeger/templates/collector-deploy.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: jaeger-collector
  labels:
    helm.sh/chart: jaeger-3.3.0
    app.kubernetes.io/name: jaeger
    app.kubernetes.io/instance: socialnetwork
    app.kubernetes.io/version: "1.53.0"
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/component: collector
spec:
  replicas: 1
  selector:
    matchLabels:
      app.kubernetes.io/name: jaeger
      app.kubernetes.io/instance: socialnetwork
      app.kubernetes.io/component: collector
  template:
    metadata:
      annotations:
        checksum/config-env: 75a11da44c802486bc6f65640aa48a730f0f684c5c07a42ba3cd1735eb3fb070
      labels:
        app.kubernetes.io/name: jaeger
        app.kubernetes.io/instance: socialnetwork
        app.kubernetes.io/component: collector
    spec:
      securityContext:
        {}
      serviceAccountName: jaeger-collector
      
      containers:
      - name: jaeger-collector
        securityContext:
          {}
        image: jaegertracing/jaeger-collector:1.53.0
        imagePullPolicy: IfNotPresent
        args:
          
          
          
        env:
          - name: SPAN_STORAGE_TYPE
            value: elasticsearch
          - name: ES_SERVER_URLS
            value: http://elasticsearch-master:9200
          - name: ES_USERNAME
            value: elastic
          - name: ES_PASSWORD
            valueFrom:
              secretKeyRef:
                name: jaeger-elasticsearch
                key: password
        ports:
        - containerPort: 14250
          name: grpc
          protocol: TCP
        - containerPort: 14268
          name: http
          protocol: TCP
        - containerPort: 14269
          name: admin
          protocol: TCP
        readinessProbe:
          httpGet:
            path: /
            port: admin
        livenessProbe:
          httpGet:
            path: /
            port: admin
        resources:
          {}
        volumeMounts:
      dnsPolicy: ClusterFirst
      restartPolicy: Always
      volumes:
---
# Source: social-network/charts/jaeger/templates/query-deploy.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: jaeger-query
  labels:
    helm.sh/chart: jaeger-3.3.0
    app.kubernetes.io/name: jaeger
    app.kubernetes.io/instance: socialnetwork
    app.kubernetes.io/version: "1.53.0"
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/component: query
spec:
  replicas: 1
  selector:
    matchLabels:
      app.kubernetes.io/name: jaeger
      app.kubernetes.io/instance: socialnetwork
      app.kubernetes.io/component: query
  template:
    metadata:
      labels:
        app.kubernetes.io/name: jaeger
        app.kubernetes.io/instance: socialnetwork
        app.kubernetes.io/component: query
    spec:
      securityContext:
        {}
      serviceAccountName: jaeger-query
       
      containers:
      - name: jaeger-query
        securityContext:
          {}
        image: jaegertracing/jaeger-query:1.53.0
        imagePullPolicy: IfNotPresent
        args:
          
          
          
        env:
          - name: SPAN_STORAGE_TYPE
            value: elasticsearch
          - name: ES_SERVER_URLS
            value: http://elasticsearch-master:9200
          - name: ES_USERNAME
            value: elastic
          - name: ES_PASSWORD
            valueFrom:
              secretKeyRef:
                name: jaeger-elasticsearch
                key: password
          - name: QUERY_BASE_PATH
            value: "/"
          - name: JAEGER_AGENT_PORT
            value: "6831"
        ports:
        - name: query
          containerPort: 16686
          protocol: TCP
        - name: grpc
          containerPort: 16685
          protocol: TCP
        - name: admin
          containerPort: 16687
          protocol: TCP
        resources:
          {}
        volumeMounts:
        livenessProbe:
          httpGet:
            path: /
            port: admin
        readinessProbe:
          httpGet:
            path: /
            port: admin
      - name: jaeger-agent-sidecar
        securityContext:
          {}
        image: jaegertracing/jaeger-agent:1.53.0
        imagePullPolicy: IfNotPresent
        args:
        env:
        - name: REPORTER_GRPC_HOST_PORT
          value: jaeger-collector:14250
        ports:
        - name: admin
          containerPort: 14271
          protocol: TCP
        resources:
          null
        volumeMounts:
        livenessProbe:
          httpGet:
            path: /
            port: admin
        readinessProbe:
          httpGet:
            path: /
            port: admin
      dnsPolicy: ClusterFirst
      restartPolicy: Always
      volumes:
---
# Source: social-network/charts/media-frontend/templates/deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    service: media-frontend
  name: media-frontend
spec: 
  replicas: 1
  selector:
    matchLabels:
      service: media-frontend
  template:
    metadata:
      labels:
        service: media-frontend
        app: media-frontend
    spec:
      tolerations:
        - effect: NoSchedule
          key: monitoring
          operator: Equal
          value: enabled
      affinity:
        nodeAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
            nodeSelectorTerms:
            - matchExpressions:
              - key: kubernetes.io/hostname
                operator: In
                values:
                - minikube
      containers:
      - name: "media-frontend"
        image: docker.io/lewisrye/media-frontend:latest
        imagePullPolicy: IfNotPresent
        ports:
        - containerPort: 8081
        env:
        - name: fqdn_suffix
          value: ".default.svc.cluster.local"
                
        volumeMounts:
        - name: media-frontend-config
          mountPath: /usr/local/openresty/nginx/conf/nginx.conf
          subPath: nginx.conf
        - name: media-frontend-config
          mountPath: /social-network-microservices/config/service-config.json
          subPath: service-config.json
        - name: media-frontend-config
          mountPath: /social-network-microservices/config/jaeger-config.yml
          subPath: jaeger-config.yml
        - name: lua-scripts
          mountPath: /usr/local/openresty/nginx/lua-scripts

      initContainers:
      - name: "alpine-container"
        image: docker.io/alpine/git:latest
        imagePullPolicy: IfNotPresent
        command: 
        - /bin/sh
        args:
        - -c
        - git clone https://github.com/gwinch97/ChaosStarBench.git /ChaosStarBench && cp -r /ChaosStarBench/socialNetwork/media-frontend/lua-scripts/* /lua-scripts/        
        volumeMounts:
        - name: lua-scripts
          mountPath: /lua-scripts
      volumes:
      - name: media-frontend-config
        configMap:
          name: media-frontend
      - name: lua-scripts
        emptyDir: {}
      hostname: media-frontend
      restartPolicy: Always
---
# Source: social-network/charts/media-memcached/templates/deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    service: media-memcached
  name: media-memcached
spec: 
  replicas: 1
  selector:
    matchLabels:
      service: media-memcached
  template:
    metadata:
      labels:
        service: media-memcached
        app: media-memcached
    spec:
      containers:
      - name: "media-memcached"
        image: docker.io/library/memcached:1.6.7
        imagePullPolicy: IfNotPresent
        ports:
        - containerPort: 11211        
        volumeMounts:
        - name: media-memcached-config
          mountPath: /social-network-microservices/config/service-config.json
          subPath: service-config.json
        - name: media-memcached-config
          mountPath: /social-network-microservices/config/jaeger-config.yml
          subPath: jaeger-config.yml
      volumes:
      - name: media-memcached-config
        configMap:
          name: media-memcached
      hostname: media-memcached
      restartPolicy: Always
---
# Source: social-network/charts/media-mongodb/templates/deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    service: media-mongodb
  name: media-mongodb
spec: 
  replicas: 1
  selector:
    matchLabels:
      service: media-mongodb
  template:
    metadata:
      labels:
        service: media-mongodb
        app: media-mongodb
    spec:
      containers:
      - name: "media-mongodb"
        image: docker.io/library/mongo:4.4.6
        imagePullPolicy: IfNotPresent
        ports:
        - containerPort: 27017
        args:
        - --config
        - /social-network-microservices/config/mongod.conf        
        volumeMounts:
        - name: media-mongodb-config
          mountPath: /social-network-microservices/config/mongod.conf
          subPath: mongod.conf
      volumes:
      - name: media-mongodb-config
        configMap:
          name: media-mongodb
      hostname: media-mongodb
      restartPolicy: Always
---
# Source: social-network/charts/media-service/templates/deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    service: media-service
  name: media-service
spec: 
  replicas: 1
  selector:
    matchLabels:
      service: media-service
  template:
    metadata:
      labels:
        service: media-service
        app: media-service
    spec:
      containers:
      - name: "media-service"
        image: docker.io/lewisrye/social-network-microservices:latest
        imagePullPolicy: IfNotPresent
        ports:
        - containerPort: 9090
        command: 
        - MediaService
        resources:
          limits:
            cpu: 1000m        
        volumeMounts:
        - name: media-service-config
          mountPath: /social-network-microservices/config/service-config.json
          subPath: service-config.json
        - name: media-service-config
          mountPath: /social-network-microservices/config/jaeger-config.yml
          subPath: jaeger-config.yml
      volumes:
      - name: media-service-config
        configMap:
          name: media-service
      hostname: media-service
      restartPolicy: Always
---
# Source: social-network/charts/nginx-thrift/templates/deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    service: nginx-thrift
  name: nginx-thrift
spec: 
  replicas: 1
  selector:
    matchLabels:
      service: nginx-thrift
  template:
    metadata:
      labels:
        service: nginx-thrift
        app: nginx-thrift
    spec:
      tolerations:
        - effect: NoSchedule
          key: monitoring
          operator: Equal
          value: enabled
      affinity:
        nodeAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
            nodeSelectorTerms:
            - matchExpressions:
              - key: kubernetes.io/hostname
                operator: In
                values:
                - minikube
      containers:
      - name: "nginx-thrift"
        image: docker.io/lewisrye/openresty-thrift:latest
        imagePullPolicy: IfNotPresent
        ports:
        - containerPort: 8080
        env:
        - name: fqdn_suffix
          value: ".default.svc.cluster.local"
                
        volumeMounts:
        - name: nginx-thrift-config
          mountPath: /usr/local/openresty/nginx/conf/nginx.conf
          subPath: nginx.conf
        - name: nginx-thrift-config
          mountPath: /social-network-microservices/config/jaeger-config.yml
          subPath: jaeger-config.yml
        - name: lua-scripts
          mountPath: /usr/local/openresty/nginx/lua-scripts
        - name: lua-thrift
          mountPath: /usr/local/openresty/lualib/thrift
        - name: pages
          mountPath: /usr/local/openresty/nginx/pages
        - name: gen-lua
          mountPath: /gen-lua
        - name: keys
          mountPath: /keys

      initContainers:
      - name: "alpine-container"
        image: docker.io/alpine/git:latest
        imagePullPolicy: IfNotPresent
        command: 
        - /bin/sh
        args:
        - -c
        - git clone https://github.com/gwinch97/ChaosStarBench.git /ChaosStarBench && cp -r /ChaosStarBench/socialNetwork/gen-lua/* /gen-lua/ && cp -r /ChaosStarBench/socialNetwork/docker/openresty-thrift/lua-thrift/* /lua-thrift/ && cp -r /ChaosStarBench/socialNetwork/nginx-web-server/lua-scripts/* /lua-scripts/ && cp -r /ChaosStarBench/socialNetwork/nginx-web-server/pages/* /pages/ && cp /ChaosStarBench/socialNetwork/keys/* /keys/         
        volumeMounts:
        - name: lua-scripts
          mountPath: /lua-scripts
        - name: lua-thrift
          mountPath: /lua-thrift
        - name: pages
          mountPath: /pages
        - name: gen-lua
          mountPath: /gen-lua
        - name: keys
          mountPath: /keys
      volumes:
      - name: nginx-thrift-config
        configMap:
          name: nginx-thrift
      - name: lua-scripts
        emptyDir: {}
      - name: pages
        emptyDir: {}
      - name: gen-lua
        emptyDir: {}
      - name: lua-thrift
        emptyDir: {}
      - name: keys
        emptyDir: {}
      hostname: nginx-thrift
      restartPolicy: Always
---
# Source: social-network/charts/post-storage-memcached/templates/deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    service: post-storage-memcached
  name: post-storage-memcached
spec: 
  replicas: 1
  selector:
    matchLabels:
      service: post-storage-memcached
  template:
    metadata:
      labels:
        service: post-storage-memcached
        app: post-storage-memcached
    spec:
      containers:
      - name: "post-storage-memcached"
        image: docker.io/library/memcached:1.6.7
        imagePullPolicy: IfNotPresent
        ports:
        - containerPort: 11211        
        volumeMounts:
        - name: post-storage-memcached-config
          mountPath: /social-network-microservices/config/service-config.json
          subPath: service-config.json
        - name: post-storage-memcached-config
          mountPath: /social-network-microservices/config/jaeger-config.yml
          subPath: jaeger-config.yml
      volumes:
      - name: post-storage-memcached-config
        configMap:
          name: post-storage-memcached
      hostname: post-storage-memcached
      restartPolicy: Always
---
# Source: social-network/charts/post-storage-mongodb/templates/deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    service: post-storage-mongodb
  name: post-storage-mongodb
spec: 
  replicas: 1
  selector:
    matchLabels:
      service: post-storage-mongodb
  template:
    metadata:
      labels:
        service: post-storage-mongodb
        app: post-storage-mongodb
    spec:
      containers:
      - name: "post-storage-mongodb"
        image: docker.io/library/mongo:4.4.6
        imagePullPolicy: IfNotPresent
        ports:
        - containerPort: 27017
        args:
        - --config
        - /social-network-microservices/config/mongod.conf        
        volumeMounts:
        - name: post-storage-mongodb-config
          mountPath: /social-network-microservices/config/mongod.conf
          subPath: mongod.conf
      volumes:
      - name: post-storage-mongodb-config
        configMap:
          name: post-storage-mongodb
      hostname: post-storage-mongodb
      restartPolicy: Always
---
# Source: social-network/charts/post-storage-service/templates/deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    service: post-storage-service
  name: post-storage-service
spec: 
  replicas: 1
  selector:
    matchLabels:
      service: post-storage-service
  template:
    metadata:
      labels:
        service: post-storage-service
        app: post-storage-service
    spec:
      containers:
      - name: "post-storage-service"
        image: docker.io/lewisrye/social-network-microservices:latest
        imagePullPolicy: IfNotPresent
        ports:
        - containerPort: 9090
        command: 
        - PostStorageService
        resources:
          limits:
            cpu: 1000m        
        volumeMounts:
        - name: post-storage-service-config
          mountPath: /social-network-microservices/config/service-config.json
          subPath: service-config.json
        - name: post-storage-service-config
          mountPath: /social-network-microservices/config/jaeger-config.yml
          subPath: jaeger-config.yml
      volumes:
      - name: post-storage-service-config
        configMap:
          name: post-storage-service
      hostname: post-storage-service
      restartPolicy: Always
---
# Source: social-network/charts/social-graph-mongodb/templates/deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    service: social-graph-mongodb
  name: social-graph-mongodb
spec: 
  replicas: 1
  selector:
    matchLabels:
      service: social-graph-mongodb
  template:
    metadata:
      labels:
        service: social-graph-mongodb
        app: social-graph-mongodb
    spec:
      containers:
      - name: "social-graph-mongodb"
        image: docker.io/library/mongo:4.4.6
        imagePullPolicy: IfNotPresent
        ports:
        - containerPort: 27017
        args:
        - --config
        - /social-network-microservices/config/mongod.conf        
        volumeMounts:
        - name: social-graph-mongodb-config
          mountPath: /social-network-microservices/config/mongod.conf
          subPath: mongod.conf
      volumes:
      - name: social-graph-mongodb-config
        configMap:
          name: social-graph-mongodb
      hostname: social-graph-mongodb
      restartPolicy: Always
---
# Source: social-network/charts/social-graph-redis/templates/deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    service: social-graph-redis
  name: social-graph-redis
spec: 
  replicas: 1
  selector:
    matchLabels:
      service: social-graph-redis
  template:
    metadata:
      labels:
        service: social-graph-redis
        app: social-graph-redis
    spec:
      containers:
      - name: "social-graph-redis"
        image: docker.io/library/redis:6.2.4
        imagePullPolicy: IfNotPresent
        ports:
        - containerPort: 6379
        args:
        - /social-network-microservices/config/redis.conf        
        volumeMounts:
        - name: social-graph-redis-config
          mountPath: /social-network-microservices/config/redis.conf
          subPath: redis.conf
      volumes:
      - name: social-graph-redis-config
        configMap:
          name: social-graph-redis
      hostname: social-graph-redis
      restartPolicy: Always
---
# Source: social-network/charts/social-graph-service/templates/deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    service: social-graph-service
  name: social-graph-service
spec: 
  replicas: 1
  selector:
    matchLabels:
      service: social-graph-service
  template:
    metadata:
      labels:
        service: social-graph-service
        app: social-graph-service
    spec:
      containers:
      - name: "social-graph-service"
        image: docker.io/lewisrye/social-network-microservices:latest
        imagePullPolicy: IfNotPresent
        ports:
        - containerPort: 9090
        command: 
        - SocialGraphService
        resources:
          limits:
            cpu: 1000m        
        volumeMounts:
        - name: social-graph-service-config
          mountPath: /social-network-microservices/config/service-config.json
          subPath: service-config.json
        - name: social-graph-service-config
          mountPath: /social-network-microservices/config/jaeger-config.yml
          subPath: jaeger-config.yml
      volumes:
      - name: social-graph-service-config
        configMap:
          name: social-graph-service
      hostname: social-graph-service
      restartPolicy: Always
---
# Source: social-network/charts/text-service/templates/deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    service: text-service
  name: text-service
spec: 
  replicas: 1
  selector:
    matchLabels:
      service: text-service
  template:
    metadata:
      labels:
        service: text-service
        app: text-service
    spec:
      containers:
      - name: "text-service"
        image: docker.io/lewisrye/social-network-microservices:latest
        imagePullPolicy: IfNotPresent
        ports:
        - containerPort: 9090
        command: 
        - TextService
        resources:
          limits:
            cpu: 1000m        
        volumeMounts:
        - name: text-service-config
          mountPath: /social-network-microservices/config/service-config.json
          subPath: service-config.json
        - name: text-service-config
          mountPath: /social-network-microservices/config/jaeger-config.yml
          subPath: jaeger-config.yml
      volumes:
      - name: text-service-config
        configMap:
          name: text-service
      hostname: text-service
      restartPolicy: Always
---
# Source: social-network/charts/unique-id-service/templates/deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    service: unique-id-service
  name: unique-id-service
spec: 
  replicas: 1
  selector:
    matchLabels:
      service: unique-id-service
  template:
    metadata:
      labels:
        service: unique-id-service
        app: unique-id-service
    spec:
      containers:
      - name: "unique-id-service"
        image: docker.io/lewisrye/social-network-microservices:latest
        imagePullPolicy: IfNotPresent
        ports:
        - containerPort: 9090
        command: 
        - UniqueIdService
        resources:
          limits:
            cpu: 1000m        
        volumeMounts:
        - name: unique-id-service-config
          mountPath: /social-network-microservices/config/service-config.json
          subPath: service-config.json
        - name: unique-id-service-config
          mountPath: /social-network-microservices/config/jaeger-config.yml
          subPath: jaeger-config.yml
      volumes:
      - name: unique-id-service-config
        configMap:
          name: unique-id-service
      hostname: unique-id-service
      restartPolicy: Always
---
# Source: social-network/charts/url-shorten-memcached/templates/deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    service: url-shorten-memcached
  name: url-shorten-memcached
spec: 
  replicas: 1
  selector:
    matchLabels:
      service: url-shorten-memcached
  template:
    metadata:
      labels:
        service: url-shorten-memcached
        app: url-shorten-memcached
    spec:
      containers:
      - name: "url-shorten-memcached"
        image: docker.io/library/memcached:1.6.7
        imagePullPolicy: IfNotPresent
        ports:
        - containerPort: 11211        
        volumeMounts:
        - name: url-shorten-memcached-config
          mountPath: /social-network-microservices/config/service-config.json
          subPath: service-config.json
        - name: url-shorten-memcached-config
          mountPath: /social-network-microservices/config/jaeger-config.yml
          subPath: jaeger-config.yml
      volumes:
      - name: url-shorten-memcached-config
        configMap:
          name: url-shorten-memcached
      hostname: url-shorten-memcached
      restartPolicy: Always
---
# Source: social-network/charts/url-shorten-mongodb/templates/deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    service: url-shorten-mongodb
  name: url-shorten-mongodb
spec: 
  replicas: 1
  selector:
    matchLabels:
      service: url-shorten-mongodb
  template:
    metadata:
      labels:
        service: url-shorten-mongodb
        app: url-shorten-mongodb
    spec:
      containers:
      - name: "url-shorten-mongodb"
        image: docker.io/library/mongo:4.4.6
        imagePullPolicy: IfNotPresent
        ports:
        - containerPort: 27017
        args:
        - --config
        - /social-network-microservices/config/mongod.conf        
        volumeMounts:
        - name: url-shorten-mongodb-config
          mountPath: /social-network-microservices/config/mongod.conf
          subPath: mongod.conf
      volumes:
      - name: url-shorten-mongodb-config
        configMap:
          name: url-shorten-mongodb
      hostname: url-shorten-mongodb
      restartPolicy: Always
---
# Source: social-network/charts/url-shorten-service/templates/deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    service: url-shorten-service
  name: url-shorten-service
spec: 
  replicas: 1
  selector:
    matchLabels:
      service: url-shorten-service
  template:
    metadata:
      labels:
        service: url-shorten-service
        app: url-shorten-service
    spec:
      containers:
      - name: "url-shorten-service"
        image: docker.io/lewisrye/social-network-microservices:latest
        imagePullPolicy: IfNotPresent
        ports:
        - containerPort: 9090
        command: 
        - UrlShortenService
        resources:
          limits:
            cpu: 1000m        
        volumeMounts:
        - name: url-shorten-service-config
          mountPath: /social-network-microservices/config/service-config.json
          subPath: service-config.json
        - name: url-shorten-service-config
          mountPath: /social-network-microservices/config/jaeger-config.yml
          subPath: jaeger-config.yml
      volumes:
      - name: url-shorten-service-config
        configMap:
          name: url-shorten-service
      hostname: url-shorten-service
      restartPolicy: Always
---
# Source: social-network/charts/user-memcached/templates/deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    service: user-memcached
  name: user-memcached
spec: 
  replicas: 1
  selector:
    matchLabels:
      service: user-memcached
  template:
    metadata:
      labels:
        service: user-memcached
        app: user-memcached
    spec:
      containers:
      - name: "user-memcached"
        image: docker.io/library/memcached:1.6.7
        imagePullPolicy: IfNotPresent
        ports:
        - containerPort: 11211        
        volumeMounts:
        - name: user-memcached-config
          mountPath: /social-network-microservices/config/service-config.json
          subPath: service-config.json
        - name: user-memcached-config
          mountPath: /social-network-microservices/config/jaeger-config.yml
          subPath: jaeger-config.yml
      volumes:
      - name: user-memcached-config
        configMap:
          name: user-memcached
      hostname: user-memcached
      restartPolicy: Always
---
# Source: social-network/charts/user-mention-service/templates/deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    service: user-mention-service
  name: user-mention-service
spec: 
  replicas: 1
  selector:
    matchLabels:
      service: user-mention-service
  template:
    metadata:
      labels:
        service: user-mention-service
        app: user-mention-service
    spec:
      containers:
      - name: "user-mention-service"
        image: docker.io/lewisrye/social-network-microservices:latest
        imagePullPolicy: IfNotPresent
        ports:
        - containerPort: 9090
        command: 
        - UserMentionService
        resources:
          limits:
            cpu: 1000m        
        volumeMounts:
        - name: user-mention-service-config
          mountPath: /social-network-microservices/config/service-config.json
          subPath: service-config.json
        - name: user-mention-service-config
          mountPath: /social-network-microservices/config/jaeger-config.yml
          subPath: jaeger-config.yml
      volumes:
      - name: user-mention-service-config
        configMap:
          name: user-mention-service
      hostname: user-mention-service
      restartPolicy: Always
---
# Source: social-network/charts/user-mongodb/templates/deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    service: user-mongodb
  name: user-mongodb
spec: 
  replicas: 1
  selector:
    matchLabels:
      service: user-mongodb
  template:
    metadata:
      labels:
        service: user-mongodb
        app: user-mongodb
    spec:
      containers:
      - name: "user-mongodb"
        image: docker.io/library/mongo:4.4.6
        imagePullPolicy: IfNotPresent
        ports:
        - containerPort: 27017
        args:
        - --config
        - /social-network-microservices/config/mongod.conf        
        volumeMounts:
        - name: user-mongodb-config
          mountPath: /social-network-microservices/config/mongod.conf
          subPath: mongod.conf
      volumes:
      - name: user-mongodb-config
        configMap:
          name: user-mongodb
      hostname: user-mongodb
      restartPolicy: Always
---
# Source: social-network/charts/user-service/templates/deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    service: user-service
  name: user-service
spec: 
  replicas: 1
  selector:
    matchLabels:
      service: user-service
  template:
    metadata:
      labels:
        service: user-service
        app: user-service
    spec:
      containers:
      - name: "user-service"
        image: docker.io/lewisrye/social-network-microservices:latest
        imagePullPolicy: IfNotPresent
        ports:
        - containerPort: 9090
        command: 
        - UserService
        resources:
          limits:
            cpu: 1000m        
        volumeMounts:
        - name: user-service-config
          mountPath: /social-network-microservices/config/service-config.json
          subPath: service-config.json
        - name: user-service-config
          mountPath: /social-network-microservices/config/jaeger-config.yml
          subPath: jaeger-config.yml
      volumes:
      - name: user-service-config
        configMap:
          name: user-service
      hostname: user-service
      restartPolicy: Always
---
# Source: social-network/charts/user-timeline-mongodb/templates/deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    service: user-timeline-mongodb
  name: user-timeline-mongodb
spec: 
  replicas: 1
  selector:
    matchLabels:
      service: user-timeline-mongodb
  template:
    metadata:
      labels:
        service: user-timeline-mongodb
        app: user-timeline-mongodb
    spec:
      containers:
      - name: "user-timeline-mongodb"
        image: docker.io/library/mongo:4.4.6
        imagePullPolicy: IfNotPresent
        ports:
        - containerPort: 27017
        args:
        - --config
        - /social-network-microservices/config/mongod.conf        
        volumeMounts:
        - name: user-timeline-mongodb-config
          mountPath: /social-network-microservices/config/mongod.conf
          subPath: mongod.conf
      volumes:
      - name: user-timeline-mongodb-config
        configMap:
          name: user-timeline-mongodb
      hostname: user-timeline-mongodb
      restartPolicy: Always
---
# Source: social-network/charts/user-timeline-redis/templates/deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    service: user-timeline-redis
  name: user-timeline-redis
spec: 
  replicas: 1
  selector:
    matchLabels:
      service: user-timeline-redis
  template:
    metadata:
      labels:
        service: user-timeline-redis
        app: user-timeline-redis
    spec:
      containers:
      - name: "user-timeline-redis"
        image: docker.io/library/redis:6.2.4
        imagePullPolicy: IfNotPresent
        ports:
        - containerPort: 6379
        args:
        - /social-network-microservices/config/redis.conf        
        volumeMounts:
        - name: user-timeline-redis-config
          mountPath: /social-network-microservices/config/redis.conf
          subPath: redis.conf
      volumes:
      - name: user-timeline-redis-config
        configMap:
          name: user-timeline-redis
      hostname: user-timeline-redis
      restartPolicy: Always
---
# Source: social-network/charts/user-timeline-service/templates/deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    service: user-timeline-service
  name: user-timeline-service
spec: 
  replicas: 1
  selector:
    matchLabels:
      service: user-timeline-service
  template:
    metadata:
      labels:
        service: user-timeline-service
        app: user-timeline-service
    spec:
      containers:
      - name: "user-timeline-service"
        image: docker.io/lewisrye/social-network-microservices:latest
        imagePullPolicy: IfNotPresent
        ports:
        - containerPort: 9090
        command: 
        - UserTimelineService
        resources:
          limits:
            cpu: 1000m        
        volumeMounts:
        - name: user-timeline-service-config
          mountPath: /social-network-microservices/config/service-config.json
          subPath: service-config.json
        - name: user-timeline-service-config
          mountPath: /social-network-microservices/config/jaeger-config.yml
          subPath: jaeger-config.yml
      volumes:
      - name: user-timeline-service-config
        configMap:
          name: user-timeline-service
      hostname: user-timeline-service
      restartPolicy: Always
---
# Source: social-network/charts/jaeger/charts/elasticsearch/templates/coordinating/statefulset.yaml
apiVersion: apps/v1
kind: StatefulSet
metadata:
  name: socialnetwork-elasticsearch-coordinating
  namespace: "default"
  labels:
    app.kubernetes.io/instance: socialnetwork
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: elasticsearch
    app.kubernetes.io/version: 8.13.2
    helm.sh/chart: elasticsearch-20.0.4
    app.kubernetes.io/component: coordinating-only
    ## Istio Labels: https://istio.io/docs/ops/deployment/requirements/
    app: coordinating-only
spec:
  replicas: 2
  selector:
    matchLabels:
      app.kubernetes.io/instance: socialnetwork
      app.kubernetes.io/name: elasticsearch
      app.kubernetes.io/component: coordinating-only
  updateStrategy:
    type: RollingUpdate
  serviceName: socialnetwork-elasticsearch-coordinating-hl
  podManagementPolicy: Parallel
  template:
    metadata:
      labels:
        app.kubernetes.io/instance: socialnetwork
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: elasticsearch
        app.kubernetes.io/version: 8.13.2
        helm.sh/chart: elasticsearch-20.0.4
        app.kubernetes.io/component: coordinating-only
        ## Istio Labels: https://istio.io/docs/ops/deployment/requirements/
        app: coordinating-only
      annotations:
    spec:
      serviceAccountName: socialnetwork-elasticsearch-coordinating
      
      automountServiceAccountToken: false
      affinity:
        podAffinity:
          
        podAntiAffinity:
          
        nodeAffinity:
          
      securityContext:
        fsGroup: 1001
        fsGroupChangePolicy: Always
        supplementalGroups: []
        sysctls: []
      initContainers:
        ## Image that performs the sysctl operation to modify Kernel settings (needed sometimes to avoid boot errors)
        - name: sysctl
          image: docker.io/bitnami/os-shell:12-debian-12-r18
          imagePullPolicy: "IfNotPresent"
          command:
            - /bin/bash
            - -ec
            - |
              CURRENT=`sysctl -n vm.max_map_count`;
              DESIRED="262144";
              if [ "$DESIRED" -gt "$CURRENT" ]; then
                  sysctl -w vm.max_map_count=262144;
              fi;
              CURRENT=`sysctl -n fs.file-max`;
              DESIRED="65536";
              if [ "$DESIRED" -gt "$CURRENT" ]; then
                  sysctl -w fs.file-max=65536;
              fi;
          securityContext:
            privileged: true
            runAsUser: 0
          resources:
            limits:
              cpu: 150m
              ephemeral-storage: 1024Mi
              memory: 192Mi
            requests:
              cpu: 100m
              ephemeral-storage: 50Mi
              memory: 128Mi
        - name: copy-default-plugins
          image: docker.io/bitnami/elasticsearch:8.13.2-debian-12-r0
          imagePullPolicy: "IfNotPresent"
          securityContext:
            allowPrivilegeEscalation: false
            capabilities:
              drop:
              - ALL
            privileged: false
            readOnlyRootFilesystem: true
            runAsGroup: 1001
            runAsNonRoot: true
            runAsUser: 1001
            seLinuxOptions: {}
            seccompProfile:
              type: RuntimeDefault
          resources:
            limits:
              cpu: 750m
              ephemeral-storage: 1024Mi
              memory: 768Mi
            requests:
              cpu: 500m
              ephemeral-storage: 50Mi
              memory: 512Mi
          command:
            - /bin/bash
          args:
            - -ec
            - |
              #!/bin/bash

              . /opt/bitnami/scripts/libfs.sh
              . /opt/bitnami/scripts/elasticsearch-env.sh

              if ! is_dir_empty "$DB_DEFAULT_PLUGINS_DIR"; then
                  cp -nr "$DB_DEFAULT_PLUGINS_DIR"/* /plugins
              fi
          volumeMounts:
            - name: empty-dir
              mountPath: /tmp
              subPath: tmp-dir
            - name: empty-dir
              mountPath: /plugins
              subPath: app-plugins-dir
      containers:
        - name: elasticsearch
          image: docker.io/bitnami/elasticsearch:8.13.2-debian-12-r0
          imagePullPolicy: "IfNotPresent"
          securityContext:
            allowPrivilegeEscalation: false
            capabilities:
              drop:
              - ALL
            privileged: false
            readOnlyRootFilesystem: true
            runAsGroup: 1001
            runAsNonRoot: true
            runAsUser: 1001
            seLinuxOptions: {}
            seccompProfile:
              type: RuntimeDefault
          env:
            - name: MY_POD_NAME
              valueFrom:
                fieldRef:
                  fieldPath: metadata.name
            - name: BITNAMI_DEBUG
              value: "false"
            - name: ELASTICSEARCH_CLUSTER_NAME
              value: "elastic"
            - name: ELASTICSEARCH_IS_DEDICATED_NODE
              value: "yes"
            - name: ELASTICSEARCH_NODE_ROLES
              value: ""
            - name: ELASTICSEARCH_TRANSPORT_PORT_NUMBER
              value: "9300"
            - name: ELASTICSEARCH_HTTP_PORT_NUMBER
              value: "9200"
            - name: ELASTICSEARCH_CLUSTER_HOSTS
              value: "socialnetwork-elasticsearch-master-hl.default.svc.cluster.local,socialnetwork-elasticsearch-coordinating-hl.default.svc.cluster.local,socialnetwork-elasticsearch-data-hl.default.svc.cluster.local,socialnetwork-elasticsearch-ingest-hl.default.svc.cluster.local,"
            - name: ELASTICSEARCH_TOTAL_NODES
              value: "4"
            - name: ELASTICSEARCH_CLUSTER_MASTER_HOSTS
              value: socialnetwork-elasticsearch-master-0 socialnetwork-elasticsearch-master-1 
            - name: ELASTICSEARCH_MINIMUM_MASTER_NODES
              value: "2"
            - name: ELASTICSEARCH_ADVERTISED_HOSTNAME
              value: "$(MY_POD_NAME).socialnetwork-elasticsearch-coordinating-hl.default.svc.cluster.local"
            - name: ELASTICSEARCH_HEAP_SIZE
              value: "128m"
          ports:
            - name: rest-api
              containerPort: 9200
            - name: transport
              containerPort: 9300
          livenessProbe:
            failureThreshold: 5
            initialDelaySeconds: 180
            periodSeconds: 10
            successThreshold: 1
            timeoutSeconds: 5
            tcpSocket:
              port: rest-api
          readinessProbe:
            failureThreshold: 5
            initialDelaySeconds: 90
            periodSeconds: 10
            successThreshold: 1
            timeoutSeconds: 5
            exec:
              command:
                - /opt/bitnami/scripts/elasticsearch/healthcheck.sh
          resources:
            limits:
              cpu: 750m
              ephemeral-storage: 1024Mi
              memory: 768Mi
            requests:
              cpu: 500m
              ephemeral-storage: 50Mi
              memory: 512Mi
          volumeMounts:
            - name: empty-dir
              mountPath: /tmp
              subPath: tmp-dir
            - name: empty-dir
              mountPath: /opt/bitnami/elasticsearch/config
              subPath: app-conf-dir
            - name: empty-dir
              mountPath: /opt/bitnami/elasticsearch/tmp
              subPath: app-tmp-dir
            - name: empty-dir
              mountPath: /opt/bitnami/elasticsearch/logs
              subPath: app-logs-dir
            - name: empty-dir
              mountPath: /opt/bitnami/elasticsearch/plugins
              subPath: app-plugins-dir
            - name: data
              mountPath: /bitnami/elasticsearch/data
      volumes:
        - name: empty-dir
          emptyDir: {}
        - name: "data"
          emptyDir: {}
---
# Source: social-network/charts/jaeger/charts/elasticsearch/templates/data/statefulset.yaml
apiVersion: apps/v1
kind: StatefulSet
metadata:
  name: socialnetwork-elasticsearch-data
  namespace: "default"
  labels:
    app.kubernetes.io/instance: socialnetwork
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: elasticsearch
    app.kubernetes.io/version: 8.13.2
    helm.sh/chart: elasticsearch-20.0.4
    app.kubernetes.io/component: data
    ## Istio Labels: https://istio.io/docs/ops/deployment/requirements/
    app: data
spec:
  replicas: 2
  podManagementPolicy: Parallel
  selector:
    matchLabels:
      app.kubernetes.io/instance: socialnetwork
      app.kubernetes.io/name: elasticsearch
      app.kubernetes.io/component: data
  serviceName: socialnetwork-elasticsearch-data-hl
  updateStrategy:
    type: RollingUpdate
  template:
    metadata:
      labels:
        app.kubernetes.io/instance: socialnetwork
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: elasticsearch
        app.kubernetes.io/version: 8.13.2
        helm.sh/chart: elasticsearch-20.0.4
        app.kubernetes.io/component: data
        ## Istio Labels: https://istio.io/docs/ops/deployment/requirements/
        app: data
      annotations:
    spec:
      serviceAccountName: socialnetwork-elasticsearch-data
      
      automountServiceAccountToken: false
      affinity:
        podAffinity:
          
        podAntiAffinity:
          
        nodeAffinity:
          
      securityContext:
        fsGroup: 1001
        fsGroupChangePolicy: Always
        supplementalGroups: []
        sysctls: []
      initContainers:
        ## Image that performs the sysctl operation to modify Kernel settings (needed sometimes to avoid boot errors)
        - name: sysctl
          image: docker.io/bitnami/os-shell:12-debian-12-r18
          imagePullPolicy: "IfNotPresent"
          command:
            - /bin/bash
            - -ec
            - |
              CURRENT=`sysctl -n vm.max_map_count`;
              DESIRED="262144";
              if [ "$DESIRED" -gt "$CURRENT" ]; then
                  sysctl -w vm.max_map_count=262144;
              fi;
              CURRENT=`sysctl -n fs.file-max`;
              DESIRED="65536";
              if [ "$DESIRED" -gt "$CURRENT" ]; then
                  sysctl -w fs.file-max=65536;
              fi;
          securityContext:
            privileged: true
            runAsUser: 0
          resources:
            limits:
              cpu: 150m
              ephemeral-storage: 1024Mi
              memory: 192Mi
            requests:
              cpu: 100m
              ephemeral-storage: 50Mi
              memory: 128Mi
        - name: copy-default-plugins
          image: docker.io/bitnami/elasticsearch:8.13.2-debian-12-r0
          imagePullPolicy: "IfNotPresent"
          securityContext:
            allowPrivilegeEscalation: false
            capabilities:
              drop:
              - ALL
            privileged: false
            readOnlyRootFilesystem: true
            runAsGroup: 1001
            runAsNonRoot: true
            runAsUser: 1001
            seLinuxOptions: {}
            seccompProfile:
              type: RuntimeDefault
          resources:
            limits:
              cpu: 750m
              ephemeral-storage: 1024Mi
              memory: 1536Mi
            requests:
              cpu: 500m
              ephemeral-storage: 50Mi
              memory: 1024Mi
          command:
            - /bin/bash
          args:
            - -ec
            - |
              #!/bin/bash

              . /opt/bitnami/scripts/libfs.sh
              . /opt/bitnami/scripts/elasticsearch-env.sh

              if ! is_dir_empty "$DB_DEFAULT_PLUGINS_DIR"; then
                  cp -nr "$DB_DEFAULT_PLUGINS_DIR"/* /plugins
              fi
          volumeMounts:
            - name: empty-dir
              mountPath: /tmp
              subPath: tmp-dir
            - name: empty-dir
              mountPath: /plugins
              subPath: app-plugins-dir
      containers:
        - name: elasticsearch
          image: docker.io/bitnami/elasticsearch:8.13.2-debian-12-r0
          imagePullPolicy: "IfNotPresent"
          securityContext:
            allowPrivilegeEscalation: false
            capabilities:
              drop:
              - ALL
            privileged: false
            readOnlyRootFilesystem: true
            runAsGroup: 1001
            runAsNonRoot: true
            runAsUser: 1001
            seLinuxOptions: {}
            seccompProfile:
              type: RuntimeDefault
          env:
            - name: BITNAMI_DEBUG
              value: "false"
            - name: MY_POD_NAME
              valueFrom:
                fieldRef:
                  fieldPath: metadata.name
            - name: ELASTICSEARCH_IS_DEDICATED_NODE
              value: "yes"
            - name: ELASTICSEARCH_NODE_ROLES
              value: "data"
            - name: ELASTICSEARCH_TRANSPORT_PORT_NUMBER
              value: "9300"
            - name: ELASTICSEARCH_HTTP_PORT_NUMBER
              value: "9200"
            - name: ELASTICSEARCH_CLUSTER_NAME
              value: "elastic"
            - name: ELASTICSEARCH_CLUSTER_HOSTS
              value: "socialnetwork-elasticsearch-master-hl.default.svc.cluster.local,socialnetwork-elasticsearch-coordinating-hl.default.svc.cluster.local,socialnetwork-elasticsearch-data-hl.default.svc.cluster.local,socialnetwork-elasticsearch-ingest-hl.default.svc.cluster.local,"
            - name: ELASTICSEARCH_TOTAL_NODES
              value: "4"
            - name: ELASTICSEARCH_CLUSTER_MASTER_HOSTS
              value: socialnetwork-elasticsearch-master-0 socialnetwork-elasticsearch-master-1 
            - name: ELASTICSEARCH_MINIMUM_MASTER_NODES
              value: "2"
            - name: ELASTICSEARCH_ADVERTISED_HOSTNAME
              value: "$(MY_POD_NAME).socialnetwork-elasticsearch-data-hl.default.svc.cluster.local"
            - name: ELASTICSEARCH_HEAP_SIZE
              value: "1024m"
          ports:
            - name: rest-api
              containerPort: 9200
            - name: transport
              containerPort: 9300
          livenessProbe:
            failureThreshold: 5
            initialDelaySeconds: 180
            periodSeconds: 10
            successThreshold: 1
            timeoutSeconds: 5
            tcpSocket:
              port: rest-api
          readinessProbe:
            failureThreshold: 5
            initialDelaySeconds: 90
            periodSeconds: 10
            successThreshold: 1
            timeoutSeconds: 5
            exec:
              command:
                - /opt/bitnami/scripts/elasticsearch/healthcheck.sh
          resources:
            limits:
              cpu: 750m
              ephemeral-storage: 1024Mi
              memory: 1536Mi
            requests:
              cpu: 500m
              ephemeral-storage: 50Mi
              memory: 1024Mi
          volumeMounts:
            - name: empty-dir
              mountPath: /tmp
              subPath: tmp-dir
            - name: empty-dir
              mountPath: /opt/bitnami/elasticsearch/config
              subPath: app-conf-dir
            - name: empty-dir
              mountPath: /opt/bitnami/elasticsearch/tmp
              subPath: app-tmp-dir
            - name: empty-dir
              mountPath: /opt/bitnami/elasticsearch/logs
              subPath: app-logs-dir
            - name: empty-dir
              mountPath: /opt/bitnami/elasticsearch/plugins
              subPath: app-plugins-dir
            - name: data
              mountPath: /bitnami/elasticsearch/data
      volumes:
        - name: empty-dir
          emptyDir: {}
  volumeClaimTemplates:
    - metadata:
        name: "data"
      spec:
        accessModes:
          - "ReadWriteOnce"
        resources:
          requests:
            storage: "8Gi"
---
# Source: social-network/charts/jaeger/charts/elasticsearch/templates/ingest/statefulset.yaml
apiVersion: apps/v1
kind: StatefulSet
metadata:
  name: socialnetwork-elasticsearch-ingest
  namespace: "default"
  labels:
    app.kubernetes.io/instance: socialnetwork
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: elasticsearch
    app.kubernetes.io/version: 8.13.2
    helm.sh/chart: elasticsearch-20.0.4
    app.kubernetes.io/component: ingest
    ## Istio Labels: https://istio.io/docs/ops/deployment/requirements/
    app: ingest
spec:
  replicas: 2
  podManagementPolicy: Parallel
  selector:
    matchLabels:
      app.kubernetes.io/instance: socialnetwork
      app.kubernetes.io/name: elasticsearch
      app.kubernetes.io/component: ingest
  serviceName: socialnetwork-elasticsearch-ingest-hl
  updateStrategy:
    type: RollingUpdate
  template:
    metadata:
      labels:
        app.kubernetes.io/instance: socialnetwork
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: elasticsearch
        app.kubernetes.io/version: 8.13.2
        helm.sh/chart: elasticsearch-20.0.4
        app.kubernetes.io/component: ingest
        ## Istio Labels: https://istio.io/docs/ops/deployment/requirements/
        app: ingest
      annotations:
    spec:
      serviceAccountName: socialnetwork-elasticsearch-ingest
      
      automountServiceAccountToken: false
      affinity:
        podAffinity:
          
        podAntiAffinity:
          
        nodeAffinity:
          
      securityContext:
        fsGroup: 1001
        fsGroupChangePolicy: Always
        supplementalGroups: []
        sysctls: []
      initContainers:
        ## Image that performs the sysctl operation to modify Kernel settings (needed sometimes to avoid boot errors)
        - name: sysctl
          image: docker.io/bitnami/os-shell:12-debian-12-r18
          imagePullPolicy: "IfNotPresent"
          command:
            - /bin/bash
            - -ec
            - |
              CURRENT=`sysctl -n vm.max_map_count`;
              DESIRED="262144";
              if [ "$DESIRED" -gt "$CURRENT" ]; then
                  sysctl -w vm.max_map_count=262144;
              fi;
              CURRENT=`sysctl -n fs.file-max`;
              DESIRED="65536";
              if [ "$DESIRED" -gt "$CURRENT" ]; then
                  sysctl -w fs.file-max=65536;
              fi;
          securityContext:
            privileged: true
            runAsUser: 0
          resources:
            limits:
              cpu: 150m
              ephemeral-storage: 1024Mi
              memory: 192Mi
            requests:
              cpu: 100m
              ephemeral-storage: 50Mi
              memory: 128Mi
        - name: copy-default-plugins
          image: docker.io/bitnami/elasticsearch:8.13.2-debian-12-r0
          imagePullPolicy: "IfNotPresent"
          securityContext:
            allowPrivilegeEscalation: false
            capabilities:
              drop:
              - ALL
            privileged: false
            readOnlyRootFilesystem: true
            runAsGroup: 1001
            runAsNonRoot: true
            runAsUser: 1001
            seLinuxOptions: {}
            seccompProfile:
              type: RuntimeDefault
          resources:
            limits:
              cpu: 750m
              ephemeral-storage: 1024Mi
              memory: 768Mi
            requests:
              cpu: 500m
              ephemeral-storage: 50Mi
              memory: 512Mi
          command:
            - /bin/bash
          args:
            - -ec
            - |
              #!/bin/bash

              . /opt/bitnami/scripts/libfs.sh
              . /opt/bitnami/scripts/elasticsearch-env.sh

              if ! is_dir_empty "$DB_DEFAULT_PLUGINS_DIR"; then
                  cp -nr "$DB_DEFAULT_PLUGINS_DIR"/* /plugins
              fi
          volumeMounts:
            - name: empty-dir
              mountPath: /tmp
              subPath: tmp-dir
            - name: empty-dir
              mountPath: /plugins
              subPath: app-plugins-dir
      containers:
        - name: elasticsearch
          image: docker.io/bitnami/elasticsearch:8.13.2-debian-12-r0
          imagePullPolicy: "IfNotPresent"
          securityContext:
            allowPrivilegeEscalation: false
            capabilities:
              drop:
              - ALL
            privileged: false
            readOnlyRootFilesystem: true
            runAsGroup: 1001
            runAsNonRoot: true
            runAsUser: 1001
            seLinuxOptions: {}
            seccompProfile:
              type: RuntimeDefault
          env:
            - name: BITNAMI_DEBUG
              value: "false"
            - name: MY_POD_NAME
              valueFrom:
                fieldRef:
                  fieldPath: metadata.name
            - name: ELASTICSEARCH_IS_DEDICATED_NODE
              value: "yes"
            - name: ELASTICSEARCH_NODE_ROLES
              value: "ingest"
            - name: ELASTICSEARCH_TRANSPORT_PORT_NUMBER
              value: "9300"
            - name: ELASTICSEARCH_HTTP_PORT_NUMBER
              value: "9200"
            - name: ELASTICSEARCH_CLUSTER_NAME
              value: "elastic"
            - name: ELASTICSEARCH_CLUSTER_HOSTS
              value: "socialnetwork-elasticsearch-master-hl.default.svc.cluster.local,socialnetwork-elasticsearch-coordinating-hl.default.svc.cluster.local,socialnetwork-elasticsearch-data-hl.default.svc.cluster.local,socialnetwork-elasticsearch-ingest-hl.default.svc.cluster.local,"
            - name: ELASTICSEARCH_TOTAL_NODES
              value: "4"
            - name: ELASTICSEARCH_CLUSTER_MASTER_HOSTS
              value: socialnetwork-elasticsearch-master-0 socialnetwork-elasticsearch-master-1 
            - name: ELASTICSEARCH_MINIMUM_MASTER_NODES
              value: "2"
            - name: ELASTICSEARCH_ADVERTISED_HOSTNAME
              value: "$(MY_POD_NAME).socialnetwork-elasticsearch-ingest-hl.default.svc.cluster.local"
            - name: ELASTICSEARCH_HEAP_SIZE
              value: "128m"
          ports:
            - name: rest-api
              containerPort: 9200
            - name: transport
              containerPort: 9300
          livenessProbe:
            failureThreshold: 5
            initialDelaySeconds: 180
            periodSeconds: 10
            successThreshold: 1
            timeoutSeconds: 5
            tcpSocket:
              port: rest-api
          readinessProbe:
            failureThreshold: 5
            initialDelaySeconds: 90
            periodSeconds: 10
            successThreshold: 1
            timeoutSeconds: 5
            exec:
              command:
                - /opt/bitnami/scripts/elasticsearch/healthcheck.sh
          resources:
            limits:
              cpu: 750m
              ephemeral-storage: 1024Mi
              memory: 768Mi
            requests:
              cpu: 500m
              ephemeral-storage: 50Mi
              memory: 512Mi
          volumeMounts:
            - name: empty-dir
              mountPath: /tmp
              subPath: tmp-dir
            - name: empty-dir
              mountPath: /opt/bitnami/elasticsearch/config
              subPath: app-conf-dir
            - name: empty-dir
              mountPath: /opt/bitnami/elasticsearch/tmp
              subPath: app-tmp-dir
            - name: empty-dir
              mountPath: /opt/bitnami/elasticsearch/logs
              subPath: app-logs-dir
            - name: empty-dir
              mountPath: /opt/bitnami/elasticsearch/plugins
              subPath: app-plugins-dir
            - name: data
              mountPath: /bitnami/elasticsearch/data
      volumes:
        - name: empty-dir
          emptyDir: {}
        - name: "data"
          emptyDir: {}
---
# Source: social-network/charts/jaeger/charts/elasticsearch/templates/master/statefulset.yaml
apiVersion: apps/v1
kind: StatefulSet
metadata:
  name: socialnetwork-elasticsearch-master
  namespace: "default"
  labels:
    app.kubernetes.io/instance: socialnetwork
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: elasticsearch
    app.kubernetes.io/version: 8.13.2
    helm.sh/chart: elasticsearch-20.0.4
    app.kubernetes.io/component: master
    ## Istio Labels: https://istio.io/docs/ops/deployment/requirements/
    app: master
spec:
  replicas: 2
  podManagementPolicy: Parallel
  selector:
    matchLabels:
      app.kubernetes.io/instance: socialnetwork
      app.kubernetes.io/name: elasticsearch
      app.kubernetes.io/component: master
  serviceName: socialnetwork-elasticsearch-master-hl
  updateStrategy:
    type: RollingUpdate
  template:
    metadata:
      labels:
        app.kubernetes.io/instance: socialnetwork
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: elasticsearch
        app.kubernetes.io/version: 8.13.2
        helm.sh/chart: elasticsearch-20.0.4
        app.kubernetes.io/component: master
        ## Istio Labels: https://istio.io/docs/ops/deployment/requirements/
        app: master
      annotations:
    spec:
      serviceAccountName: socialnetwork-elasticsearch-master
      
      automountServiceAccountToken: false
      affinity:
        podAffinity:
          
        podAntiAffinity:
          
        nodeAffinity:
          
      securityContext:
        fsGroup: 1001
        fsGroupChangePolicy: Always
        supplementalGroups: []
        sysctls: []
      initContainers:
        ## Image that performs the sysctl operation to modify Kernel settings (needed sometimes to avoid boot errors)
        - name: sysctl
          image: docker.io/bitnami/os-shell:12-debian-12-r18
          imagePullPolicy: "IfNotPresent"
          command:
            - /bin/bash
            - -ec
            - |
              CURRENT=`sysctl -n vm.max_map_count`;
              DESIRED="262144";
              if [ "$DESIRED" -gt "$CURRENT" ]; then
                  sysctl -w vm.max_map_count=262144;
              fi;
              CURRENT=`sysctl -n fs.file-max`;
              DESIRED="65536";
              if [ "$DESIRED" -gt "$CURRENT" ]; then
                  sysctl -w fs.file-max=65536;
              fi;
          securityContext:
            privileged: true
            runAsUser: 0
          resources:
            limits:
              cpu: 150m
              ephemeral-storage: 1024Mi
              memory: 192Mi
            requests:
              cpu: 100m
              ephemeral-storage: 50Mi
              memory: 128Mi
        - name: copy-default-plugins
          image: docker.io/bitnami/elasticsearch:8.13.2-debian-12-r0
          imagePullPolicy: "IfNotPresent"
          securityContext:
            allowPrivilegeEscalation: false
            capabilities:
              drop:
              - ALL
            privileged: false
            readOnlyRootFilesystem: true
            runAsGroup: 1001
            runAsNonRoot: true
            runAsUser: 1001
            seLinuxOptions: {}
            seccompProfile:
              type: RuntimeDefault
          resources:
            limits:
              cpu: 750m
              ephemeral-storage: 1024Mi
              memory: 768Mi
            requests:
              cpu: 500m
              ephemeral-storage: 50Mi
              memory: 512Mi
          command:
            - /bin/bash
          args:
            - -ec
            - |
              #!/bin/bash

              . /opt/bitnami/scripts/libfs.sh
              . /opt/bitnami/scripts/elasticsearch-env.sh

              if ! is_dir_empty "$DB_DEFAULT_PLUGINS_DIR"; then
                  cp -nr "$DB_DEFAULT_PLUGINS_DIR"/* /plugins
              fi
          volumeMounts:
            - name: empty-dir
              mountPath: /tmp
              subPath: tmp-dir
            - name: empty-dir
              mountPath: /plugins
              subPath: app-plugins-dir
      containers:
        - name: elasticsearch
          image: docker.io/bitnami/elasticsearch:8.13.2-debian-12-r0
          imagePullPolicy: "IfNotPresent"
          securityContext:
            allowPrivilegeEscalation: false
            capabilities:
              drop:
              - ALL
            privileged: false
            readOnlyRootFilesystem: true
            runAsGroup: 1001
            runAsNonRoot: true
            runAsUser: 1001
            seLinuxOptions: {}
            seccompProfile:
              type: RuntimeDefault
          env:
            - name: BITNAMI_DEBUG
              value: "false"
            - name: MY_POD_NAME
              valueFrom:
                fieldRef:
                  fieldPath: metadata.name
            - name: ELASTICSEARCH_IS_DEDICATED_NODE
              value: "yes"
            - name: ELASTICSEARCH_NODE_ROLES
              value: "master"
            - name: ELASTICSEARCH_TRANSPORT_PORT_NUMBER
              value: "9300"
            - name: ELASTICSEARCH_HTTP_PORT_NUMBER
              value: "9200"
            - name: ELASTICSEARCH_CLUSTER_NAME
              value: "elastic"
            
            - name: ELASTICSEARCH_CLUSTER_HOSTS
              value: "socialnetwork-elasticsearch-master-hl.default.svc.cluster.local,socialnetwork-elasticsearch-coordinating-hl.default.svc.cluster.local,socialnetwork-elasticsearch-data-hl.default.svc.cluster.local,socialnetwork-elasticsearch-ingest-hl.default.svc.cluster.local,"
            - name: ELASTICSEARCH_TOTAL_NODES
              value: "4"
            - name: ELASTICSEARCH_CLUSTER_MASTER_HOSTS
              value: socialnetwork-elasticsearch-master-0 socialnetwork-elasticsearch-master-1 
            - name: ELASTICSEARCH_MINIMUM_MASTER_NODES
              value: "2"
            - name: ELASTICSEARCH_ADVERTISED_HOSTNAME
              value: "$(MY_POD_NAME).socialnetwork-elasticsearch-master-hl.default.svc.cluster.local"
            - name: ELASTICSEARCH_HEAP_SIZE
              value: "128m"
          ports:
            - name: rest-api
              containerPort: 9200
            - name: transport
              containerPort: 9300
          livenessProbe:
            failureThreshold: 5
            initialDelaySeconds: 180
            periodSeconds: 10
            successThreshold: 1
            timeoutSeconds: 5
            tcpSocket:
              port: rest-api
          readinessProbe:
            failureThreshold: 5
            initialDelaySeconds: 90
            periodSeconds: 10
            successThreshold: 1
            timeoutSeconds: 5
            exec:
              command:
                - /opt/bitnami/scripts/elasticsearch/healthcheck.sh
          resources:
            limits:
              cpu: 750m
              ephemeral-storage: 1024Mi
              memory: 768Mi
            requests:
              cpu: 500m
              ephemeral-storage: 50Mi
              memory: 512Mi
          volumeMounts:
            - name: empty-dir
              mountPath: /tmp
              subPath: tmp-dir
            - name: empty-dir
              mountPath: /opt/bitnami/elasticsearch/config
              subPath: app-conf-dir
            - name: empty-dir
              mountPath: /opt/bitnami/elasticsearch/tmp
              subPath: app-tmp-dir
            - name: empty-dir
              mountPath: /opt/bitnami/elasticsearch/logs
              subPath: app-logs-dir
            - name: empty-dir
              mountPath: /opt/bitnami/elasticsearch/plugins
              subPath: app-plugins-dir
            - name: data
              mountPath: /bitnami/elasticsearch/data
      volumes:
        - name: empty-dir
          emptyDir: {}
  volumeClaimTemplates:
    - metadata:
        name: "data"
      spec:
        accessModes:
          - "ReadWriteOnce"
        resources:
          requests:
            storage: "8Gi"
---
# Source: social-network/charts/jaeger/templates/elasticsearch-secret.yaml
apiVersion: v1
kind: Secret
metadata:
  name: jaeger-elasticsearch
  labels:
    helm.sh/chart: jaeger-3.3.0
    app.kubernetes.io/name: jaeger
    app.kubernetes.io/instance: socialnetwork
    app.kubernetes.io/version: "1.53.0"
    app.kubernetes.io/managed-by: Helm
  annotations:
    "helm.sh/hook": pre-install,pre-upgrade
    "helm.sh/hook-weight": "-1"
    "helm.sh/hook-delete-policy": before-hook-creation
    "helm.sh/resource-policy": keep
type: Opaque
data:
  password: "Y2hhbmdlbWU="
